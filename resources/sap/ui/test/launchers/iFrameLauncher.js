/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/ObjectPath","sap/ui/Device","sap/ui/test/_LogCollector","sap/ui/thirdparty/jquery"],function(e,t,r,n,jQuery){"use strict";var i=1280;var a=1024;var s=null,o=null,u=null,c=null,l=null,h=null,f=false,d=false,p=null,g=null,y,w;function v(){s=o[0].contentWindow;H();b()}function m(e,t){if(e){o.css("width",e);u.css("padding-left",e)}else{o.css("width",i);o.addClass("default-scale-x")}if(t){o.css("height",t)}else{o.css("height",a);o.addClass("default-scale-y")}if(!e&&!t){o.addClass("default-scale-both")}}function H(){var e=s.onerror;s.onerror=function(t,r,n,i,a){var s=false;if(e){s=e.apply(this,arguments)}setTimeout(function(){var e=i?"\ncolumn: "+i:"";var s=a&&"\niFrame error: "+(a.stack?a.message+"\n"+a.stack:a)||"";throw new Error("Error in launched application iFrame: "+t+"\nurl: "+r+"\nline: "+n+e+s)},0);return s}}function b(){if(d){return true}if(!f&&s?.sap?.ui){if(s.sap.ui.require){const e=s.sap.ui.require("sap/ui/core/Core");if(typeof e?.ready==="function"){e.ready(F);f=true;return d}if(typeof e?.attachInit==="function"){e.attachInit(F);f=true}}}return d}function L(e){s.sap.ui.require(["sap/ui/thirdparty/sinon"],function(t){if(!t){setTimeout(function(){L(e)},50)}else{e()}})}function F(){I();if(r.browser.firefox){L(q)}else{q()}}function C(e){e.addLogListener(n.getInstance()._oListener);d=true}function I(){U("sap/ui/test");U("sap/ui/qunit");U("sap/ui/thirdparty")}function P(t,r,n){var i=new n,a=new r(i),o=t.setHash,u=t.getHash,c,l=false,h=s.history.go;t.replaceHash=function(e){l=true;var t=this.getHash();c=e;i.fireEvent("hashReplaced",{sHash:e});this.changed.dispatch(e,t)};t.setHash=function(e){l=true;var t=u.call(this);c=e;i.fireEvent("hashSet",{sHash:e});o.apply(this,arguments);if(t===this.getHash()){this.changed.dispatch(t,a.aHistory[a.iHistoryPosition])}};t.getHash=function(){if(c===undefined){return u.apply(this,arguments)}return c};t.changed.add(function(e){if(!l){i.fireEvent("hashSet",{sHash:e});c=e}l=false});i.init();function f(){l=true;var e=a.aHistory[a.iHistoryPosition],r=a.getPreviousHash();c=r;t.changed.dispatch(r,e)}function d(){l=true;var r=a.aHistory[a.iHistoryPosition+1],n=a.aHistory[a.iHistoryPosition];if(r===undefined){e.error("Could not navigate forwards, there is no history entry in the forwards direction",this);return}c=r;t.changed.dispatch(r,n)}s.history.back=f;s.history.forward=d;s.history.go=function(t){if(t===-1){f();return}else if(t===1){d();return}e.error("Using history.go with a number greater than 1 is not supported by OPA5",this);return h.apply(s.history,arguments)}}function q(){s.sap.ui.require(["sap/base/Log","sap/ui/test/OpaPlugin","sap/ui/test/autowaiter/_autoWaiter","sap/ui/test/_OpaLogger","sap/ui/qunit/QUnitUtils","sap/ui/thirdparty/jquery","sap/ui/thirdparty/hasher","sap/ui/core/routing/History","sap/ui/core/routing/HashChanger"],function(e,t,r,n,i,a,s,o,u){n.setLevel(y);c=new t;p=r;l=i;h=a;if(!w){P(s,o,u)}g=u;C(e)})}function E(e){var t=sap.ui.require.toUrl(e);var r=new URL(t,document.baseURI);r.search=r.hash="";return r.href}function U(e){var r=E(e);var n=t.get("sap.ui.loader.config",s);if(n){var i={};i[e]=r;n({paths:i});return}if(h&&h.sap&&h.sap.registerResourcePath){h.sap.registerResourcePath(e,r);return}throw new Error("iFrameLauncher.js: UI5 module system not found.")}function O(){if(!s){throw new Error("sap.ui.test.launchers.iFrameLauncher: Teardown was called before launch. No iFrame was loaded.")}s.onerror=jQuery.noop;for(var e=0;e<o.length;e++){o[0].src="about:blank";o[0].contentWindow.document.write("");o[0].contentWindow.close()}if(typeof CollectGarbage=="function"){CollectGarbage()}o.remove();u.remove();h=null;c=null;l=null;s=null;d=false;f=false;p=null;g=null}return{launch:function(t){if(s){throw new Error("sap.ui.test.launchers.iFrameLauncher: Launch was called twice without teardown. Only one iFrame may be loaded at a time.")}o=jQuery("#"+t.frameId);if(o.length){u=jQuery(".opaFrameContainer")}else{if(!t.source){e.error("No source was given to launch the IFrame",this)}u=jQuery("<div class='opaFrameContainer'></div>");o=jQuery('<IFrame id="'+t.frameId+'" class="opaFrame" src="'+t.source+'"></IFrame>');u.append(o);jQuery("body").append(u);m(t.width,t.height)}if(o[0].contentDocument&&o[0].contentDocument.readyState==="complete"){v()}else{o.on("load",v)}y=t.opaLogLevel;w=t.disableHistoryOverride;return b()},hasLaunched:function(){b();return d},teardown:function(){O()},getHashChanger:function(){if(!g){return null}return g.getInstance()},getPlugin:function(){return c},getJQuery:function(){return h},getUtils:function(){return l},getWindow:function(){return s},_getAutoWaiter:function(){return p}}},true);
//# sourceMappingURL=iFrameLauncher.js.map