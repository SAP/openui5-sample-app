/*!
 * copyright
 */
sap.ui.define(["sap/base/assert","sap/base/config","sap/base/Event","sap/base/Eventing","sap/base/future","sap/base/Log","sap/base/i18n/Localization","sap/base/util/deepEqual","sap/ui/core/theming/ThemeHelper"],function(e,t,n,a,i,o,s,h,c){"use strict";const r=t.getWritableInstance();const l=new a;let g;const m={getTheme:()=>{let e=r.get({name:"sapTheme",type:r.Type.String,defaultValue:r.get({name:"sapUiTheme",type:r.Type.String,external:true}),external:true});if(e===""){const t=c.getDefaultThemeInfo();e=`${t.DEFAULT_THEME}${t.DARK_MODE?"_dark":""}`}const t=e.indexOf("@");if(t>=0){const n=T(e.slice(t+1));e=t>0?e.slice(0,t):e;if(n!==m.getThemeRoot(e)){m.setThemeRoot(e,n)}}e=c.validateAndFallbackTheme(e,m.getThemeRoot(e));return e},setTheme:e=>{if(e){if(e.indexOf("@")!==-1){throw new TypeError("Providing a theme root as part of the theme parameter is not allowed.")}const t=m.getTheme();r.set("sapTheme",e);const n=m.getTheme();const a=t!==n;if(a){const e={theme:{new:n,old:t}};p(e)}if(!g&&a){f({theme:n})}}},getThemeRoot:(e,t)=>{const n=r.get({name:"sapUiThemeRoots",type:r.Type.MergedObject});let a;e??=m.getTheme();if(n[e]&&typeof n[e]==="string"){a=n[e]}else if(n[e]&&typeof n[e]==="object"){a=n[e][t]||n[e][""]}return a},setThemeRoot:(t,n,a,i)=>{e(typeof t==="string","sThemeName must be a string");e(typeof n==="string","sThemeBaseUrl must be a string");const o={name:"sapUiThemeRoots",type:r.Type.MergedObject};const s=r.get(Object.assign(o,{defaultValue:{}}));const c=r.get(Object.assign(o,{defaultValue:{}}));if(typeof a==="boolean"){i=a;a=undefined}c[t]??={};if(typeof c[t]==="string"){c[t]={"":c[t]};s[t]={"":s[t]}}if(a){for(let e=0;e<a.length;e++){const i=a[e];c[t][i]=n}}else{c[t][""]=n}if(!h(s,c)){const e={};r.set("sapUiThemeRoots",c);if(a){e["themeRoots"]={new:Object.assign({},c[t]),old:Object.assign({},s[t])}}else{e["themeRoots"]={new:n,old:s[t]?.[""]}}e["themeRoots"].forceUpdate=i&&t===m.getTheme();p(e)}},attachAppliedOnce:e=>{const t="applied";if(g){if(g.themeLoaded){e.call(null,new n(t,{theme:m.getTheme()}))}else{l.attachEventOnce(t,e)}}else{e.call(null,new n(t,{theme:m.getTheme()}))}},attachApplied:e=>{const t="applied";l.attachEvent(t,e);if(g){if(g.themeLoaded){e.call(null,new n(t,{theme:m.getTheme()}))}}else{e.call(null,new n(t,{theme:m.getTheme()}))}},detachApplied:e=>{l.detachEvent("applied",e)},attachChange:e=>{l.attachEvent("change",e)},detachChange:e=>{l.detachEvent("change",e)},attachThemeScopingChanged:e=>{l.attachEvent("themeScopingChanged",e)},detachThemeScopingChanged:e=>{l.detachEvent("themeScopingChanged",e)},fireThemeScopingChanged:e=>{l.fireEvent("themeScopingChanged",e)},notifyContentDensityChanged:()=>{f({theme:m.getTheme()})},registerThemeManager:e=>{g=e;g._attachThemeApplied(function(e){f(n.getParameters(e))});s.attachChange(function(e){var t=e.rtl;if(t!==undefined){g._updateThemeUrls(m.getTheme())}})}};function p(e){if(e){l.fireEvent("change",e)}}function f(e){l.fireEvent("applied",e)}function d(e,t){const n=r.get({name:"sapAllowedThemeOrigins",type:r.Type.String});return!!n?.split(",").some(n=>{try{n=t&&!n.startsWith("//")?"//"+n:n;return n==="*"||e===new URL(n.trim(),window.location.href).origin}catch(e){i.errorThrows("sapAllowedThemeOrigins provides invalid theme origin: "+n,{cause:e});return false}})}function T(e){const t=e.startsWith("//");let n,a;try{n=new URL(e,window.location.href);n.search="";if(n.origin&&d(n.origin,t)){a=n.toString()}else{n=new URL(n.pathname,window.location.href);a=n.toString()}if(t){a=a.replace(n.protocol,"")}a+=(a.endsWith("/")?"":"/")+"UI5/"}catch(e){}return a}return m});
//# sourceMappingURL=Theming.js.map