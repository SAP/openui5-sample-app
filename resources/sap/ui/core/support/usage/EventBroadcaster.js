/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","../../Component","../../Element","../../routing/Router"],function(e,t,n,o){"use strict";var a={};var i={global:["modelContextChange","beforeRendering","afterRendering","propertyChanged","beforeGeometryChanged","geometryChanged","aggregationChanged","componentCreated","afterInit","updateStarted","updateFinished","load","scroll"],controls:{}};a.getEventsExcludeList=function(){return JSON.parse(JSON.stringify(i))};a.setEventsExcludeList=function(t){if(this._isValidConfig(t)){i=JSON.parse(JSON.stringify(t))}else{if(e.isLoggable()){e.error("Provided ExcludeList configuration is not valid. Continuing to use previously/default set configuration.")}}};a.enable=function(){n._interceptEvent=function(e,t,n){a.broadcastEvent(e,t,n)};o._interceptRouteMatched=function(e,t){a.broadcastRouteMatched(o.M_EVENTS.ROUTE_MATCHED,e,t)}};a.disable=function(){if(n._interceptEvent){delete n._interceptEvent}if(o._interceptRouteMatched){delete o._interceptRouteMatched}};a.broadcastEvent=function(t,n,o){var i=new Date;setTimeout(function(){var r={},s;if(a._shouldExpose(t,n)){s=a._createOwnerComponentInfo(n);r={componentId:s.id,componentVersion:s.version,eventName:t,targetId:n.getId(),targetType:n.getMetadata().getName(),timestamp:i.getTime()};if(e.isLoggable()){e.debug("EventBroadcaster: Broadcast Event: ",JSON.stringify(r))}r.additionalAttributes=o;a._dispatchCustomEvent(r)}})};a.broadcastRouteMatched=function(t,o,i){var r=new Date;setTimeout(function(){var s=a._createOwnerComponentInfo(n.getElementById(o)),d={componentId:s.id,componentVersion:s.version,eventName:t,targetId:o,targetType:"sap.ui.core.routing.Router",timestamp:r.getTime(),additionalAttributes:{fullURL:document&&document.baseURI,hash:i.getHashChanger().getHash(),previousHash:a._previousHash}};a._previousHash=d.additionalAttributes.hash;if(e.isLoggable()){e.debug("EventBroadcaster: Broadcast Route Matched: ",JSON.stringify(d))}a._dispatchCustomEvent(d)})};a._dispatchCustomEvent=function(e){var t=new window.CustomEvent("UI5Event",{detail:e});window.dispatchEvent(t)};a._shouldExpose=function(e,t){var n=a.getEventsExcludeList(),o=n.global.indexOf(e)===-1&&a._isPublicElementEvent(e,t),i=a._isTrackableControlEvent(n,e,t);return o&&i};a._isTrackableControlEvent=function(e,t,n){var o,a,i=true,r=n.getMetadata().getName();if(e.controls[r]){o=e.controls[r].exclude;a=e.controls[r].include;if(!o&&!a){i=false}if(a&&a.indexOf(t)>-1){i=true}if(o&&o.indexOf(t)>-1){i=false}}return i};a._isPublicElementEvent=function(e,t){return t.getMetadata().hasEvent(e)};a._isValidConfig=function(e){var t=e.hasOwnProperty("global"),n=e.hasOwnProperty("controls");return t&&n};a._createOwnerComponentInfo=function(e){var n,o,a,i;if(e){while(e&&e.getParent){a=t.getOwnerComponentFor(e);if(a||e.getMetadata().isA("sap.ui.core.Component")){a=a||e;i=a.getManifestEntry("sap.app");n=i&&i.id||a.getMetadata().getName();o=i&&i.applicationVersion&&i.applicationVersion.version}e=e.getParent()}}return{id:n||"undetermined",version:o||""}};return a});
//# sourceMappingURL=EventBroadcaster.js.map