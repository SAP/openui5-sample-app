/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/assert","sap/ui/base/EventProvider","sap/ui/core/Component","sap/ui/core/mvc/_ViewFactory","sap/ui/core/mvc/View","sap/ui/core/routing/HashChanger","sap/ui/core/routing/sync/TargetCache"],function(e,t,n,o,r,i,s,a){"use strict";var c=n.extend("sap.ui.core.routing.TargetCache",{constructor:function(e){if(!e){e={}}if(e.async===undefined){e.async=true}this._oCache={view:{},component:{}};this._oComponent=e.component;if(this._oComponent){t(this._oComponent.isA("sap.ui.core.UIComponent"),this+" - the component passed to the constructor needs to be an instance of UIComponent")}n.apply(this,arguments);this.async=e.async;if(!e.async){for(const e in a){this[e]=a[e]}}},metadata:{publicMethods:["get","set"]},get:function(t,n){var o;try{if(n==="Component"&&!this.async){e.error("sap.ui.core.routing.Target doesn't support loading component in synchronous mode, please switch routing to async");throw new Error("sap.ui.core.routing.Target doesn't support loading component in synchronous mode, please switch routing to async")}if(!t){e.error("the oOptions parameter of getObject is mandatory",this);throw new Error("the oOptions parameter of getObject is mandatory")}o=this._get(t,n)}catch(e){return Promise.reject(e)}if(o instanceof Promise){return o}else if(o.isA("sap.ui.core.mvc.View")){return o.loaded()}else{return Promise.resolve(o)}},fetch:function(e,t){return this._get(e,t,undefined,undefined,true)},set:function(e,n,o){var r;this._checkName(e,n);t(n==="View"||n==="Component","sType must be either 'View' or 'Component'");r=this._oCache[n.toLowerCase()][e];if(!r){r=this._oCache[n.toLowerCase()][e]={}}r[undefined]=o;return this},destroy:function(){n.prototype.destroy.apply(this);if(this.bIsDestroyed){return this}function e(e){if(e&&e.destroy&&!e._bIsBeingDestroyed){e.destroy()}}Object.keys(this._oCache).forEach(function(t){var n=this._oCache[t];Object.keys(n).forEach(function(t){var o=n[t];Object.keys(o).forEach(function(t){var n=o[t];if(n instanceof Promise){n.then(e)}else{e(n)}})})}.bind(this));this._oCache=undefined;this.bIsDestroyed=true;return this},attachCreated:function(e,t,n){return this.attachEvent("created",e,t,n)},detachCreated:function(e,t){return this.detachEvent("created",e,t)},fireCreated:function(e){return this.fireEvent("created",e)},_get:function(e,t,n,o,r){var i;switch(t){case"View":i=this._getView(e,n,r);break;case"Component":i=this._getComponent(e,n,o,r);break;default:throw Error("The given sType: "+t+" isn't supported by TargetCache.getObject")}return i},_getView:function(e,t,n){if(!t){e=this._createId(e)}return this._getViewWithGlobalId(e,false,n)},_getComponent:function(e,t,n,o){if(!t){e=this._createId(e)}return this._getComponentWithGlobalId(e,n,o)},_createId:function(e){if(this._oComponent&&e.id){e=Object.assign({},e,{id:this._oComponent.createId(e.id)})}return e},_checkName:function(t,n){if(!t){var o="A name for the "+n.toLowerCase()+" has to be defined";e.error(o,this);throw Error(o)}},_getObjectWithGlobalId:function(e,t,n,s,a){var c=this,h,u,f,d=this._oComponent,p=[];n=n||{};function g(){const a=!e.async||s;switch(t){case"View":e.viewName=e.name;delete e.name;if(a){return r.create(e)}else{return i.create(e)}case"Component":e.settings=e.settings||{};e.settings._propagateTitle=n.propagateTitle;var h=c._createRouterHashChanger(n.prefix);if(h){e.settings._routerHashChanger=h}if(e.usage){return d.createComponent(e)}else{return o.create(e)}default:}}function m(o){if(c._oCache){p.forEach(function(e){f[e]=o});if(n.afterCreate){n.afterCreate(o)}c.fireCreated({object:o,type:t,options:e})}return o}if(e.async===undefined){e.async=true}u=e.usage||e.name;this._checkName(u,t);f=this._oCache[t.toLowerCase()][u];h=f&&f[e.id];if(a||h){return h}if(d){h=d.runAsOwner(g);if(h instanceof Promise){d.registerForDestroy(h)}}else{h=g()}if(h instanceof Promise){h=h.then(m)}else{h.loaded().then(m)}if(!f){f=this._oCache[t.toLowerCase()][u]={};f[undefined]=h;p.push(undefined)}if(e.id!==undefined){f[e.id]=h;p.push(e.id)}return h},_getViewWithGlobalId:function(e,t,n){if(e&&!e.name){e.name=e.viewName}return this._getObjectWithGlobalId(e,"View",undefined,t,n)},_getComponentWithGlobalId:function(e,t,n){return this._getObjectWithGlobalId(e,"Component",t,n)},_createRouterHashChanger:function(e){var t;var n=this._oComponent&&this._oComponent.getRouter();if(n){t=n.getHashChanger();if(t&&e){t=t.createSubHashChanger(e)}}return t||s.getInstance().createRouterHashChanger()}});return c});
//# sourceMappingURL=TargetCache.js.map