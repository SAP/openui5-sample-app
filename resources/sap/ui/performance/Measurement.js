/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/base/Log","sap/base/util/now"],function(e,t){"use strict";function r(){function r(e,t,r,n,i){this.id=e;this.info=t;this.start=r;this.end=n;this.pause=0;this.resume=0;this.duration=0;this.time=0;this.categories=i;this.average=false;this.count=0;this.completeDuration=0}function n(e){if(!f){return true}if(!e){return f===null}for(var t=0;t<f.length;t++){if(e.indexOf(f[t])>-1){return true}}return false}function i(e){if(!e){e=["javascript"]}e=typeof e==="string"?e.split(","):e;if(!n(e)){return null}return e}function u(e,t){for(var r=0;r<t.length;r++){if(e.categories.indexOf(t[r])>-1){return true}}return t.length===0}var s=false,a=XMLHttpRequest,f=null,o=[],l=[],d={},c={};this.getActive=function(){return s};this.setActive=function(e,t){var r,n;if(!t){t=null}else if(typeof t==="string"){t=t.split(",")}f=t;if(s===e){return}s=e;if(s){for(var i in d){this[i]=d[i].bind(this)}d={};r=this.end;n=this.start;XMLHttpRequest=function(){var e=new a,t=e.open,i;e.open=function(){i=new URL(arguments[1],document.baseURI).href;n(i,"Request for "+i,"xmlhttprequest");e.addEventListener("loadend",r.bind(null,i));t.apply(this,arguments)};return e}}else{XMLHttpRequest=a}return s};d["start"]=function(n,u,a){if(!s){return}a=i(a);if(!a){return}var f=t(),o=new r(n,u,f,0,a);if(e.getLevel("sap.ui.Performance")>=4){console?.time(u+" - "+n)}e.info("Performance measurement start: "+n+" on "+f);if(o){c[n]=o;return this.getMeasurement(o.id)}else{return false}};d["pause"]=function(r){if(!s){return}var n=t();var i=c[r];if(i&&i.end>0){return false}if(i&&i.pause==0){i.pause=n;if(i.pause>=i.resume&&i.resume>0){i.duration=i.duration+i.pause-i.resume;i.resume=0}else if(i.pause>=i.start){i.duration=i.pause-i.start}}if(i){e.info("Performance measurement pause: "+r+" on "+n+" duration: "+i.duration);return this.getMeasurement(i.id)}else{return false}};d["resume"]=function(r){if(!s){return}var n=t();var i=c[r];if(i&&i.pause>0){i.pause=0;i.resume=n}if(i){e.info("Performance measurement resume: "+r+" on "+n+" duration: "+i.duration);return this.getMeasurement(i.id)}else{return false}};d["end"]=function(r){if(!s){return}var n=t();var i=c[r];if(i&&!i.end){e.info("Performance measurement end: "+r+" on "+n);i.end=n;if(i.end>=i.resume&&i.resume>0){i.duration=i.duration+i.end-i.resume;i.resume=0}else if(i.pause>0){i.pause=0}else if(i.end>=i.start){if(i.average){i.completeDuration+=i.end-i.start;i.count++;i.duration=i.completeDuration/i.count;i.start=n}else{i.duration=i.end-i.start}}if(i.end>=i.start){i.time=i.end-i.start}}if(i){if(e.getLevel("sap.ui.Performance")>=4){console?.timeEnd(i.info+" - "+r)}return this.getMeasurement(r)}else{return false}};d["clear"]=function(){c={}};d["remove"]=function(e){delete c[e]};d["add"]=function(e,t,n,u,a,f,o){if(!s){return}o=i(o);if(!o){return false}var l=new r(e,t,n,u,o);l.time=a;l.duration=f;if(l){c[e]=l;return this.getMeasurement(l.id)}else{return false}};d["average"]=function(e,r,n){if(!s){return}n=i(n);if(!n){return}var u=c[e],a=t();if(!u||!u.average){this.start(e,r,n);u=c[e];u.average=true}else{if(!u.end){u.completeDuration+=a-u.start;u.count++}u.start=a;u.end=0}return this.getMeasurement(u.id)};this.getMeasurement=function(e){var t=c[e];if(t){var r={};for(var n in t){r[n]=t[n]}return r}else{return false}};this.getAllMeasurements=function(e){return this.filterMeasurements(function(e){return e},e)};this.filterMeasurements=function(){var e,t,r=0,n=[],i=typeof arguments[r]==="function"?arguments[r++]:undefined,s=typeof arguments[r]==="boolean"?arguments[r++]:undefined,a=Array.isArray(arguments[r])?arguments[r]:[];for(var f in c){e=this.getMeasurement(f);t=s===false&&e.end===0||s!==false&&(!s||e.end);if(t&&u(e,a)&&(!i||i(e))){n.push(e)}}return n};this.registerMethod=function(t,r,n,i){var u=r[n];if(u&&typeof u==="function"){var s=o.indexOf(u)>-1;if(!s){l.push({func:u,obj:r,method:n,id:t});var a=this;r[n]=function(){a.average(t,t+" method average",i);var e=u.apply(this,arguments);a.end(t);return e};o.push(r[n]);return true}}else{e.debug(n+" in not a function. Measurement.register failed")}return false};this.unregisterMethod=function(e,t,r){var n=t[r],i=o.indexOf(n);if(n&&i>-1){t[r]=l[i].func;o.splice(i,1);l.splice(i,1);return true}return false};this.unregisterAllMethods=function(){while(l.length>0){var e=l[0];this.unregisterMethod(e.id,e.obj,e.method)}};var h=location.search.match(/sap-ui-measure=([^\&]*)/);if(h&&h[1]){if(h[1]==="true"||h[1]==="x"||h[1]==="X"){this.setActive(true)}else{this.setActive(true,h[1])}}else{var m=function(){return null};for(var p in d){this[p]=m}}}return new r});
//# sourceMappingURL=Measurement.js.map