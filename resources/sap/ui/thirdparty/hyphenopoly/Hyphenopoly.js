/**
 * @license Hyphenopoly 3.4.0 - client side hyphenation for webbrowsers
 * ©2019  Mathias Nater, Zürich (mathiasnater at gmail dot com)
 * https://github.com/mnater/Hyphenopoly
 *
 * Released under the MIT license
 * http://mnater.github.io/Hyphenopoly/LICENSE
 */
(function e(n){"use strict";var t=String.fromCharCode(173);function r(){return Object.create(null)}Math.imul=Math.imul||function e(n,t){var r=n>>>16&65535;var a=n&65535;var i=t>>>16&65535;var o=t&65535;return a*o+(r*o+a*i<<16>>>0)|0};function a(e,n){return{configurable:(n&4)>0,enumerable:(n&2)>0,writable:(n&1)>0,value:e}}function i(e){e.addEventListener("copy",function e(r){r.preventDefault();var a=n.getSelection();var i=a.getRangeAt(0).cloneContents();var o=document.createElement("div");o.appendChild(i);var l=o.innerHTML;var s=a.toString();r.clipboardData.setData("text/plain",s.replace(new RegExp(t,"g"),""));r.clipboardData.setData("text/html",l.replace(new RegExp(t,"g"),""))},true)}(function e(n){var i=Object.create(null,{defaultLanguage:a("en-us",2),dontHyphenate:a(function e(){var n=r();var t="abbr,acronym,audio,br,button,code,img,input,kbd,label,math,option,pre,samp,script,style,sub,sup,svg,textarea,var,video";t.split(",").forEach(function e(t){n[t]=true});return n}(),2),dontHyphenateClass:a("donthyphenate",2),exceptions:a(r(),2),keepAlive:a(true,2),normalize:a(false,2),safeCopy:a(true,2),timeout:a(1e3,2)});var o=Object.create(i);var l=Object.create(null,{compound:a("hyphen",2),hyphen:a(t,2),leftmin:a(0,2),leftminPerLang:a(0,2),minWordLength:a(6,2),mixedCase:a(true,2),orphanControl:a(1,2),rightmin:a(0,2),rightminPerLang:a(0,2)});Object.keys(n.setup).forEach(function e(t){if(t==="selectors"){var s=Object.keys(n.setup.selectors);Object.defineProperty(o,"selectors",a(s,2));s.forEach(function e(t){var i=r();Object.keys(n.setup.selectors[t]).forEach(function e(r){i[r]=a(n.setup.selectors[t][r],2)});Object.defineProperty(o,t,a(Object.create(l,i),2))})}else if(t==="dontHyphenate"){var c=r();Object.keys(n.setup.dontHyphenate).forEach(function e(t){c[t]=a(n.setup.dontHyphenate[t],2)});Object.defineProperty(o,t,a(Object.create(i.dontHyphenate,c),3))}else{Object.defineProperty(o,t,a(n.setup[t],3))}});n.c=o})(Hyphenopoly);(function e(t){var o=t.c;var l=null;var s=null;function c(){var e=new Map;var n=[0];function r(t,r,a){var i={element:t,selector:a};if(!e.has(r)){e.set(r,[])}e.get(r).push(i);n[0]+=1;return i}function a(r){var a=0;if(e.has(r)){a=e.get(r).length;e.delete(r);n[0]-=a;if(n[0]===0){t.events.dispatch("hyphenopolyEnd")}}}function i(n){e.forEach(function e(t,r){n(r,t)})}return{add:r,counter:n,each:i,list:e,rem:a}}function f(e,n){try{return e.getAttribute("lang")?e.getAttribute("lang").toLowerCase():e.tagName.toLowerCase()==="html"?n?l:null:f(e.parentNode,n)}catch(e){return null}}function u(){var e=n.document.getElementsByTagName("html")[0];l=f(e,false);if(!l&&o.defaultLanguage!==""){l=o.defaultLanguage}}function h(e,n){if(!e.matches){e.matches=e.msMatchesSelector||e.webkitMatchesSelector}return e.matches(n)}function p(){s=c();var e=function e(){var n="."+t.c.dontHyphenateClass;var r=null;for(r in o.dontHyphenate){if(o.dontHyphenate[r]){n+=", "+r}}return n}();var r=o.selectors.join(", ")+", "+e;function a(e,n){if(e.lang&&typeof e.lang==="string"){return e.lang.toLowerCase()}else if(n&&n!==""){return n.toLowerCase()}return f(e,true)}function l(e,n,c,f){f=f||false;var u=a(e,n);if(t.cf.langs[u]==="H9Y"){s.add(e,u,c);if(!f&&o.safeCopy){i(e)}}else if(!t.cf.langs[u]){t.events.dispatch("error",{lvl:"warn",msg:"Element with '"+u+"' found, but '"+u+".hpb' not loaded. Check language tags!"})}var p=e.childNodes;Array.prototype.forEach.call(p,function e(n){if(n.nodeType===1&&!h(n,r)){l(n,u,c,true)}})}o.selectors.forEach(function e(t){var r=n.document.querySelectorAll(t);Array.prototype.forEach.call(r,function e(n){l(n,f(n,true),t,false)})});t.elementsReady=true}var g=new Map;function m(e,n,r){var a=o[r];var i=a.hyphen;e.cache.set(r,new Map);function l(t){var i=String.fromCharCode(8203);var o=null;var l=null;if(a.compound==="auto"||a.compound==="all"){l=m(e,n,r);o=t.split("-").map(function e(n){if(n.length>=a.minWordLength){return l(n)}return n});if(a.compound==="auto"){t=o.join("-")}else{t=o.join("-"+i)}}else{t=t.replace("-","-"+i)}return t}function s(e){return Array.prototype.map.call(e,function e(n){return n===n.toLowerCase()}).some(function e(n,t,r){return n!==r[0]})}function c(o){var c=e.cache.get(r).get(o);if(!a.mixedCase&&s(o)){c=o}if(!c){if(e.exceptions.has(o)){c=e.exceptions.get(o).replace(/-/g,a.hyphen)}else if(o.indexOf("-")===-1){if(o.length>61){t.events.dispatch("error",{lvl:"warn",msg:"found word longer than 61 characters"});c=o}else{c=e.hyphenateFunction(o,i.charCodeAt(0),a.leftminPerLang[n],a.rightminPerLang[n])}}else{c=l(o)}e.cache.get(r).set(o,c)}return c}g.set(n+"-"+r,c);return c}var d=new Map;function v(e){function n(n,t,r,a){var i=o[e];var l=i.hyphen;if(".\\+*?[^]$(){}=!<>|:-".indexOf(i.hyphen)!==-1){l="\\"+i.hyphen}if(i.orphanControl===3&&t===" "){t=String.fromCharCode(160)}return t+r.replace(new RegExp(l,"g"),"")+a}d.set(e,n);return n}function y(e,n,r){var a=t.languages.get(e);var i=o[n];var l=i.minWordLength;var c=o.normalize&&Boolean(String.prototype.normalize);var f=e+"-"+n;var u=g.has(f)?g.get(f):m(a,e,n);var h=d.has(n)?d.get(n):v(n);var p=a.genRegExps.get(n);function y(e){var n=null;if(c){n=e.normalize("NFC").replace(p,u)}else{n=e.replace(p,u)}if(i.orphanControl!==1){n=n.replace(/(\u0020*)(\S+)(\s*)$/,h)}return n}function b(n){t.events.dispatch("beforeElementHyphenation",{el:n,lang:e});var r=n.childNodes;Array.prototype.forEach.call(r,function e(n){if(n.nodeType===3&&n.data.length>=l){n.data=y(n.data)}});s.counter[0]-=1;t.events.dispatch("afterElementHyphenation",{el:n,lang:e})}var w=null;if(typeof r==="string"){w=y(r)}else if(r instanceof HTMLElement){b(r)}return w}t.createHyphenator=function e(n){return function e(t,r){r=r||".hyphenate";return y(n,r,t)}};t.unhyphenate=function e(){s.each(function e(n,t){t.forEach(function e(n){var t=n.element.firstChild;var r=o[n.selector].hyphen;t.data=t.data.replace(new RegExp(r,"g"),"")})})};function b(e,n){if(n){n.forEach(function n(t){y(e,t.selector,t.element)})}else{t.events.dispatch("error",{lvl:"warn",msg:"engine for language '"+e+"' loaded, but no elements found."})}if(s.counter[0]===0){t.events.dispatch("hyphenopolyEnd")}}function w(e){var n=new Map;e.split(", ").forEach(function e(t){var r=t.replace(/-/g,"");n.set(r,t)});return n}function E(e){if(!t.languages){t.languages=new Map}if(!t.languages.has(e)){t.languages.set(e,r())}return t.languages.get(e)}function x(e,n,i,l,s){i=i.replace(/-/g,"");var c=E(e);if(!c.engineReady){c.cache=new Map;if(t.c.exceptions.global){if(t.c.exceptions[e]){t.c.exceptions[e]+=", "+t.c.exceptions.global}else{t.c.exceptions[e]=t.c.exceptions.global}}if(t.c.exceptions[e]){c.exceptions=w(t.c.exceptions[e]);delete t.c.exceptions[e]}else{c.exceptions=new Map}c.genRegExps=new Map;c.leftmin=l;c.rightmin=s;c.hyphenateFunction=n;o.selectors.forEach(function n(t){var l=o[t];if(l.leftminPerLang===0){Object.defineProperty(l,"leftminPerLang",a(r(),2))}if(l.rightminPerLang===0){Object.defineProperty(l,"rightminPerLang",a(r(),2))}if(l.leftminPerLang[e]){l.leftminPerLang[e]=Math.max(c.leftmin,l.leftmin,l.leftminPerLang[e])}else{l.leftminPerLang[e]=Math.max(c.leftmin,l.leftmin)}if(l.rightminPerLang[e]){l.rightminPerLang[e]=Math.max(c.rightmin,l.rightmin,l.rightminPerLang[e])}else{l.rightminPerLang[e]=Math.max(c.rightmin,l.rightmin)}c.genRegExps.set(t,new RegExp("[\\w"+i+String.fromCharCode(8204)+"-]{"+l.minWordLength+",}","gi"))});c.engineReady=true}Hyphenopoly.events.dispatch("engineReady",{msg:e})}function L(e){if(t.cf.wasm){return Math.ceil(e/65536)*65536}var n=Math.ceil(Math.log(e)*Math.LOG2E);if(n<=12){return 1<<12}if(n<24){return 1<<n}return Math.ceil(e/(1<<24))*(1<<24)}var M=function e(){if(n.TextDecoder){var t=new TextDecoder("utf-16le");return function e(n){return t.decode(n)}}return function e(n){return String.fromCharCode.apply(null,n)}}();function A(e){var n=new Uint32Array(e).subarray(0,8);if(n[0]!==40005736){t.events.dispatch("error",{lvl:"error",msg:"Pattern file format error: "+new Uint8Array(Uint32Array.of(n[0]).buffer)});throw new Error("Pattern file format error!")}var r=n[7];var a=1280;var i=a+r+(4-(a+r)%4);var o=i+n[6]*4;return{ho:o+512,hp:o+192,hs:Math.max(L(o+512+n[2]+n[3]),32*1024*64),hw:o+256,lm:n[4],pl:n[3],po:o+512+n[2],pt:i,rm:n[5],to:o+512+n[1],tw:o+128,vs:a,wo:o}}function C(e,n){var r=t.cf.wasm?e.wasmMemory.buffer:e.heapBuffer;var a=new Uint16Array(r).subarray(e.wo>>1,(e.wo>>1)+64);var i=new Uint16Array(r).subarray(e.hw>>1,(e.hw>>1)+128);a[0]=95;return function e(t,r,o,l){var s=0;var c=0;do{c=t.charCodeAt(s);s+=1;a[s]=c}while(c);a[s]=95;a[s+1]=0;if(n(o,l,r)===1){t=M(i.subarray(1,i[0]+1))}return t}}function H(e){Promise.all([t.bins.get(e),t.bins.get("hyphenEngine")]).then(function n(r){var a=r[0];var i=A(a);var o=r[1];var l=t.specMems.get(e);var s=l.buffer.byteLength>=i.hs?l:new WebAssembly.Memory({initial:i.hs/65536,maximum:256});var c=new Uint32Array(s.buffer);c.set(new Uint32Array(a),i.ho>>2);i.wasmMemory=s;WebAssembly.instantiate(o,{env:{memory:i.wasmMemory,memoryBase:0},x:i}).then(function n(t){var r=t.exports.convert();x(e,C(i,t.exports.hyphenate),M(new Uint16Array(s.buffer).subarray(385,384+r)),i.lm,i.rm)})})}function P(e){var r=t.bins.get(e);var a=A(r);var i=t.specMems.get(e);var o=i.byteLength>=a.hs?i:new ArrayBuffer(a.hs);var l=new Uint8Array(o);var s=new Uint8Array(r);l.set(s,a.ho);a.heapBuffer=o;var c=asmHyphenEngine({Int32Array:n.Int32Array,Math:Math,Uint16Array:n.Uint16Array,Uint8Array:n.Uint8Array},a,a.heapBuffer);var f=c.convert();x(e,C(a,c.hyphenate),M(new Uint16Array(o).subarray(385,384+f)),a.lm,a.rm)}var O=null;var j=[];function R(e,n){if(e==="*"){if(n==="wasm"){O=H}else if(n==="asm"){O=P}j.forEach(function e(n){O(n)})}else if(O){O(e)}else{j.push(e)}}t.events.define("contentLoaded",function e(){u();p();t.events.dispatch("elementsReady")},false);t.events.define("elementsReady",function e(){s.each(function e(n,r){if(t.languages&&t.languages.has(n)&&t.languages.get(n).engineReady){b(n,r)}})},false);t.events.define("engineLoaded",function e(n){R("*",n.msg)},false);t.events.define("hpbLoaded",function e(n){R(n.msg,"*")},false);t.events.addListener("loadError",function e(n){if(n.msg!=="wasm"){s.rem(n.name)}},false);t.events.define("engineReady",function e(n){if(t.elementsReady){b(n.msg,s.list.get(n.msg))}},false);t.events.define("hyphenopolyStart",null,true);t.events.define("hyphenopolyEnd",function e(){n.clearTimeout(o.timeOutHandler);if(o.hide!=="none"){t.toggle("on")}if(!o.keepAlive){window.Hyphenopoly=null}},false);t.events.define("beforeElementHyphenation",null,true);t.events.define("afterElementHyphenation",null,true);t.events.tempRegister.forEach(function e(n){t.events.addListener(n.name,n.handler,false)});delete t.events.tempRegister;t.events.dispatch("hyphenopolyStart",{msg:"Hyphenopoly started"});n.clearTimeout(t.c.timeOutHandler);Object.defineProperty(o,"timeOutHandler",a(n.setTimeout(function e(){t.events.dispatch("timeout",{delay:o.timeout})},o.timeout),2));t.events.deferred.forEach(function e(n){t.events.dispatch(n.name,n.data)});delete t.events.deferred})(Hyphenopoly)})(window);
//# sourceMappingURL=Hyphenopoly.js.map