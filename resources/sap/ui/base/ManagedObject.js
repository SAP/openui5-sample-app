/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./_runWithOwner","./DataType","./EventProvider","./ManagedObjectMetadata","./Object","./BindingInfo","sap/ui/util/ActivityDetection","sap/ui/util/_enforceNoReturnValue","sap/base/future","sap/base/util/ObjectPath","sap/base/Log","sap/base/assert","sap/base/util/deepClone","sap/base/util/deepEqual","sap/base/util/uid","sap/base/util/extend","sap/base/util/isEmptyObject"],function(t,e,i,n,r,s,o,a,g,p,f,d,h,l,u,c,y){"use strict";const b=e.getType("sap.ui.core.ID");const m=Symbol("bindingInfoFactory");var v=i.extend("sap.ui.base.ManagedObject",{metadata:{abstract:true,publicMethods:["getId","getMetadata","getModel","setModel","hasModel","bindProperty","unbindProperty","bindAggregation","unbindAggregation","bindObject","unbindObject","getObjectBinding"],library:"sap.ui.core",properties:{},aggregations:{},associations:{},events:{validationSuccess:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"}}},validationError:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"},message:{type:"string"}}},parseError:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"},message:{type:"string"}}},formatError:{enableEventBubbling:true,parameters:{element:{type:"sap.ui.base.ManagedObject"},property:{type:"string"},type:{type:"sap.ui.model.Type"},newValue:{type:"any"},oldValue:{type:"any"}}},modelContextChange:{}},specialSettings:{id:"sap.ui.core.ID",models:"object",bindingContexts:"object",objectBindings:"object",metadataContexts:"object",Type:{type:"string",visibility:"hidden"}}},constructor:function(e,n,r){i.call(this);const s=this;if(typeof e!=="string"&&e!==undefined){r=n;n=e;e=n&&n.id}if(!e){e=this.getMetadata().uid()}else{e=B?B.call(this,e):e;if(!b.isValid(e)){throw new Error(`"${e}" is not a valid ID.`)}}this.sId=e;this.mProperties=this.getMetadata().createPropertyBag();this.mAggregations={};this.mAssociations={};this.oParent=null;this.aDelegates=[];this.aBeforeDelegates=[];this.iSuppressInvalidate=0;this.oPropagatedProperties=x;this.mSkipPropagation={};this._bIsOwnerActive=true;this.oModels={};this.aPropagationListeners=[];this.oBindingContexts={};this.mElementBindingContexts={};this.mBindingInfos={};this.mObjectBindingInfos={};this._oContextualSettings=O;this._sOwnerId=t.getCurrentOwnerId();(function(){var t=false;if(s.register){s.register()}try{if(s._initCompositeSupport){s._initCompositeSupport(n)}if(s.init){a(s.init(),{name:"init",component:s.getId()})}s.applySettings(n,r);t=true}finally{if(!t&&s.deregister){s.deregister()}}})()}},n);function P(t){d(t===undefined||typeof t==="string"&&!/^(undefined|null)?$/.test(t),"sModelName must be a string or omitted")}var A=false;function I(t){if(!A){var e=Object.values(t)[0];if(e&&e.mixinBindingSupport){e.mixinBindingSupport(v.prototype);A=true}}}function _(t,e,i){if(!t||t instanceof v||typeof t!=="object"||t instanceof String){return t}function n(t){if(typeof t==="function"){return t}if(typeof t==="string"){const e=p.get(t);if(e!=null){f.error(`Defining the object type ('${t}') via its string name is deprecated, since it leads to accesses to the global namespace. `+`The object type either stems from an explicitly given 'Type' value or was inferred from the default aggregation type. `+`Please require the respective object type module beforehand. `+`For control development, please also refer to the runtime metadata property 'defaultClass', which allows you to specify a default aggregation class type via constructor reference.`)}return e}}let r;r=n(t.Type);r??=e?.defaultClass;r??=n(e?.type);if(typeof r==="function"){return new r(t,i)}var s="Don't know how to create a ManagedObject from "+t+" ("+typeof t+")";f.fatal(s);throw new Error(s)}v.create=_;let B=null;let C=null;v.runWithPreprocessors=function(t,e,i){d(typeof t==="function","fn must be a function");d(!e||typeof e==="object","oPreprocessors must be an object");const n=[B,C];B=e?.id;C=e?.settings;try{return t.call(i)}finally{[B,C]=n}};v.prototype.applySettings=function(t,i){if(!t||y(t)){return this}var n=this,s=this.getMetadata(),o=s.getJSONKeys(),a,p,f;function h(t){for(var e=0,r=t.length;e<r;e++){var s=t[e];if(Array.isArray(s)){h(s)}else{n[f._sMutator](_(s,f,i))}}}function l(t){n[f._sMutator](t[0],t[1],t[2])}function u(t){var i=e.getType(t),n=i&&i.getPrimitiveType().getName();return n==="object"||n==="any"}C?.call(this,t);if(t.metadataContexts&&this._processMetadataContexts){this._processMetadataContexts(t.metadataContexts,t)}if(t.models){if(typeof t.models!=="object"){throw new Error("models must be a simple object")}if(r.isObjectA(t.models,"sap.ui.model.Model")){this.setModel(t.models)}else{for(a in t.models){this.setModel(t.models[a],a==="undefined"?undefined:a)}}}if(t.bindingContexts){if(typeof t.bindingContexts!=="object"){throw new Error("bindingContexts must be a simple object")}var c=t.bindingContexts;if(r.isObjectA(c,"sap.ui.model.Context")){this.setBindingContext(t.bindingContexts)}else{for(a in t.bindingContexts){this.setBindingContext(t.bindingContexts[a],a==="undefined"?undefined:a)}}}if(t.objectBindings){if(typeof t.objectBindings!=="string"&&typeof t.objectBindings!=="object"){throw new Error("binding must be a string or simple object")}if(typeof t.objectBindings==="string"||t.objectBindings.path){this.bindObject(t.objectBindings)}else{for(a in t.objectBindings){t.objectBindings[a].model=a==="undefined"?undefined:a;this.bindObject(t.objectBindings[a])}}}for(a in t){p=t[a];if((f=o[a])!==undefined){var b;switch(f._iKind){case 0:b=this.extractBindingInfo(p,i,!u(f.type));if(b&&typeof b==="object"){this.bindProperty(a,b)}else{this[f._sMutator](typeof b==="string"?b:p)}break;case 1:b=f.altTypes&&this.extractBindingInfo(p,i,!f.altTypes.some(u));if(b&&typeof b==="object"){this.bindProperty(a,b)}else{if(Array.isArray(p)){if(p.length>1){g.errorThrows("Tried to add an array of controls to a single aggregation")}p=p[0]}this[f._sMutator](_(typeof b==="string"?b:p,f,i))}break;case 2:b=this.extractBindingInfo(p,i);if(b&&typeof b==="object"){this.bindAggregation(a,b)}else{p=typeof b==="string"?b:p;if(p){if(Array.isArray(p)){h(p)}else{n[f._sMutator](_(p,f,i))}}}break;case 3:this[f._sMutator](p);break;case 4:if(p){if(Array.isArray(p)){for(var m=0,v=p.length;m<v;m++){this[f._sMutator](p[m])}}else{this[f._sMutator](p)}}break;case 5:if(typeof p=="function"){this[f._sMutator](p)}else if(Array.isArray(p[0])&&(p.length<=1||Array.isArray(p[1]))){p.forEach(l)}else{l(p)}break;case-1:break;default:break}}else{d(false,"ManagedObject.apply: encountered unknown setting '"+a+"' for class '"+s.getName()+"' (value:'"+p+"')")}}return this};v.escapeSettingsValue=function(t){return typeof t==="string"?s.escape(t):t};v.prototype.toString=function(){return"ManagedObject "+this.getMetadata().getName()+"#"+this.getId()};v.prototype.getId=function(){return this.sId};v.prototype.setProperty=function(t,e,n){var r=this.mProperties[t];e=this.validateProperty(t,e);if(l(r,e)){this.mProperties[t]=e;return this}if(n){o.refresh()}this.mProperties[t]=e;if(!n&&!this.isInvalidateSuppressed()){this.invalidate()}this.updateModelProperty(t,e,r);e=this.mProperties[t];if(this.mEventRegistry["_change"]){i.prototype.fireEvent.call(this,"_change",{id:this.getId(),name:t,oldValue:r,newValue:e})}if(this._observer){this._observer.propertyChange(this,t,r,e)}return this};v.prototype.getProperty=function(t){var i=this.mProperties[t],n=this.getMetadata().getManagedProperty(t),r;if(!n){throw new Error('Property "'+t+'" does not exist in '+this)}r=e.getType(n.type);if(r instanceof e&&r.isArrayType()&&Array.isArray(i)){i=i.slice(0)}if(i instanceof String){i=i.valueOf()}if(n.byValue){i=h(i)}return i};v.prototype.validateProperty=function(t,i){var n=this.getMetadata().getManagedProperty(t),r;if(!n){throw new Error('Property "'+t+'" does not exist in '+this)}r=e.getType(n.type);if(r instanceof e&&r.isArrayType()&&Array.isArray(i)){i=i.slice(0)}if(i==null){i=n.getDefaultValue()}else if(r instanceof e){if(r.getName()=="string"){if(!(typeof i=="string"||i instanceof String)){i=""+i}}else if(r.getName()=="string[]"){if(typeof i=="string"){i=[i]}if(!Array.isArray(i)){throw new Error('"'+i+'" is of type '+typeof i+", expected string[]"+' for property "'+t+'" of '+this)}for(var s=0;s<i.length;s++){if(typeof i[s]!=="string"){i[s]=""+i[s]}}}else if(!r.isValid(i)){throw new Error('"'+i+'" is of type '+typeof i+", expected "+r.getName()+' for property "'+t+'" of '+this)}}if(n.byValue){i=h(i)}if(r&&r.normalize&&typeof r.normalize==="function"){i=r.normalize(i)}return i};v.prototype.isPropertyInitial=function(t){return!Object.hasOwn(this.mProperties,t)&&!this.isBound(t)};v.prototype.resetProperty=function(t){if(this.mProperties.hasOwnProperty(t)){var e=this.getMetadata().getManagedProperty(t);e.set(this,null);if(this.mProperties[t]===e.getDefaultValue()){delete this.mProperties[t]}}return this};v.prototype.getOriginInfo=function(t){var e=this.mProperties[t];if(!(e instanceof String&&e.originInfo)){return null}return e.originInfo};v.prototype.setAssociation=function(t,e,i){if(e instanceof v){e=e.getId()}else if(e!=null&&typeof e!=="string"){d(false,"setAssociation(): sId must be a string, an instance of sap.ui.base.ManagedObject or null");return this}if(this.mAssociations[t]===e){return this}if(i){this.iSuppressInvalidate++}if(this._observer&&this.mAssociations[t]!=null){this._observer.associationChange(this,t,"remove",this.mAssociations[t])}this.mAssociations[t]=e;if(this._observer&&this.mAssociations[t]!=null){this._observer.associationChange(this,t,"insert",e)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(i){this.iSuppressInvalidate--}return this};v.prototype.getAssociation=function(t,e){var i=this.mAssociations[t];if(!i){i=this.mAssociations[t]=e||null}else{if(typeof i.length==="number"&&!i.propertyIsEnumerable("length")){return i.slice()}return i}return i};v.prototype.addAssociation=function(t,e,i){if(e instanceof v){e=e.getId()}else if(typeof e!=="string"){d(false,"addAssociation(): sId must be a string or an instance of sap.ui.base.ManagedObject");return this}if(i){this.iSuppressInvalidate++}var n=this.mAssociations[t];if(!n){n=this.mAssociations[t]=[e]}else{n.push(e)}if(this._observer){this._observer.associationChange(this,t,"insert",e)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(i){this.iSuppressInvalidate--}return this};v.prototype.removeAssociation=function(t,e,i){var n=this.mAssociations[t];var r=null;if(!n){return null}if(i){this.iSuppressInvalidate++}if(typeof e=="object"&&e.getId){e=e.getId()}if(typeof e=="string"){for(var s=0;s<n.length;s++){if(n[s]==e){e=s;break}}}if(typeof e=="number"){if(e>=0&&e<n.length){r=n[e];n.splice(e,1);if(this._observer){this._observer.associationChange(this,t,"remove",r)}if(!this.isInvalidateSuppressed()){this.invalidate()}}}if(i){this.iSuppressInvalidate--}return r};v.prototype.removeAllAssociation=function(t,e){var i=this.mAssociations[t];if(!i){return[]}delete this.mAssociations[t];if(!i.length){return i}if(e){this.iSuppressInvalidate++}if(this._observer){this._observer.associationChange(this,t,"remove",i)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(e){this.iSuppressInvalidate--}return i};v.prototype.validateAggregation=function(t,i,n,s){var o=this.getMetadata(),a=o.getManagedAggregation(t),g,f,h,l;if(!a){throw new Error('Aggregation "'+t+'" does not exist in '+this)}if(a.multiple!==n){throw new Error("Aggregation '"+t+"' of "+this+" used with wrong cardinality (declared as "+(a.multiple?"0..n":"0..1")+")")}var u=o.getAggregationForwarder(t);if(u&&!s){u.getTarget(this).validateAggregation(u.targetAggregationName,i,n)}if(!a.multiple&&!i){return i}if(r.isObjectA(i,a.type)){return i}g=a.altTypes;if(g&&g.length){if(i==null){return i}for(h=0;h<g.length;h++){f=e.getType(g[h]);if(f instanceof e){if(f.isValid(i)){return i}}}}if((()=>{f=p.get(a.type);if(typeof f==="function"&&i instanceof f){return true}return false})()){return i}l='"'+i+'" is not valid for aggregation "'+t+'" of '+this;if(e.isInterfaceType(a.type)){d(false,l);return i}else{throw new Error(l)}};v.prototype.setAggregation=function(t,e,i){var n=this.getMetadata().getAggregationForwarder(t);if(n){e=this.validateAggregation(t,e,false,true);return n.set(this,e)}var r=this.mAggregations[t];if(r===e){return this}e=this.validateAggregation(t,e,false);if(i){this.iSuppressInvalidate++}this.mAggregations[t]=null;if(r instanceof v){r.setParent(null)}else{if(this._observer!=null&&r!=null){this._observer.aggregationChange(this,t,"remove",r)}}this.mAggregations[t]=e;if(e instanceof v){e.setParent(this,t,i)}else{if(!this.isInvalidateSuppressed()){this.invalidate()}if(this._observer!=null&&e!=null){this._observer.aggregationChange(this,t,"insert",e)}}if(i){this.iSuppressInvalidate--}return this};v.prototype.getAggregation=function(t,e){var i=this.getMetadata().getAggregationForwarder(t);if(i){return i.get(this)}var n=this.mAggregations[t];if(!n){n=this.mAggregations[t]=e||null}if(n){if(typeof n.length==="number"&&!n.propertyIsEnumerable("length")){return n.slice()}return n}else{return null}};v.prototype.indexOfAggregation=function(t,e){var i=this.getMetadata().getAggregationForwarder(t);if(i){return i.indexOf(this,e)}var n=this.mAggregations[t];if(n){if(n.length==undefined){return-2}for(var r=0;r<n.length;r++){if(n[r]==e){return r}}}return-1};v.prototype.insertAggregation=function(t,e,i,n){if(!e){return this}e=this.validateAggregation(t,e,true,true);var r=this.getMetadata().getAggregationForwarder(t);if(r){return r.insert(this,e,i)}var s=this.mAggregations[t]||(this.mAggregations[t]=[]);var o;if(i<0){o=0}else if(i>s.length){o=s.length}else{o=i}s.splice(o,0,e);e.setParent(this,t,n);return this};v.prototype.addAggregation=function(t,e,i){if(!e){return this}e=this.validateAggregation(t,e,true,true);var n=this.getMetadata().getAggregationForwarder(t);if(n){return n.add(this,e)}var r=this.mAggregations[t];if(!r){r=this.mAggregations[t]=[e]}else{r.push(e)}e.setParent(this,t,i);return this};v.prototype.removeAggregation=function(t,e,i){var n=this.getMetadata().getAggregationForwarder(t);if(n){return n.remove(this,e)}var r=this.mAggregations[t],s=null,o;if(!r){return null}if(i){this.iSuppressInvalidate++}if(typeof e=="string"){for(o=0;o<r.length;o++){if(r[o]&&r[o].getId()===e){e=o;break}}}if(typeof e=="object"){for(o=0;o<r.length;o++){if(r[o]==e){e=o;break}}}if(typeof e=="number"){if(e>=0&&e<r.length){s=r[e];r.splice(e,1);s.setParent(null);if(!this.isInvalidateSuppressed()){this.invalidate()}}}if(i){this.iSuppressInvalidate--}return s};v.prototype.removeAllAggregation=function(t,e){var i=this.getMetadata().getAggregationForwarder(t);if(i){return i.removeAll(this)}var n=this.mAggregations[t];if(!n){return[]}delete this.mAggregations[t];if(!n.length){return n}if(e){this.iSuppressInvalidate++}for(var r=0;r<n.length;r++){n[r].setParent(null)}if(!this.isInvalidateSuppressed()){this.invalidate()}if(e){this.iSuppressInvalidate--}return n};v.prototype.destroyAggregation=function(t,e){var i=this.getMetadata().getAggregationForwarder(t);if(i){return i.destroy(this)}var n=this.mAggregations[t],r,s;if(!n){return this}delete this.mAggregations[t];if(Array.isArray(n)&&!n.length){return this}if(e){this.iSuppressInvalidate++}if(n instanceof v){n.destroy(e);if(this._observer){this._observer.aggregationChange(this,t,"remove",n)}}else if(Array.isArray(n)){for(r=n.length-1;r>=0;r--){s=n[r];if(s){s.destroy(e);if(this._observer){this._observer.aggregationChange(this,t,"remove",s)}}}}if(!this.isInvalidateSuppressed()){this.invalidate()}if(e){this.iSuppressInvalidate--}return this};v.prototype.invalidate=function(){if(this.oParent&&this.oParent.isInvalidateSuppressed&&!this.oParent.isInvalidateSuppressed()){this.oParent.invalidate(this)}};v.prototype.isInvalidateSuppressed=function(){return this.iSuppressInvalidate>0};v.prototype._removeChild=function(t,e,i){if(!e){g.errorThrows(`${this}: Cannot remove aggregated child without aggregation name.`)}else{if(i){this.iSuppressInvalidate++}var n=this.indexOfAggregation(e,t);var r=this.getMetadata().getAggregation(e);if(n==-2){if(r&&this[r._sMutator]){this[r._sMutator](null)}else{this.setAggregation(e,null,i)}}else if(n>-1){if(r&&this[r._sRemoveMutator]){this[r._sRemoveMutator](n)}else{this.removeAggregation(e,n,i)}}if(i){this.iSuppressInvalidate--}}};function M(t,e){while(t&&t!==e){t=t.oParent}return!!t}v.prototype.setParent=function(t,e,i){d(t==null||t instanceof v,"oParent either must be null, undefined or a ManagedObject");var n;if(!t){if(this.oParent){n=this._observer||this.oParent._observer;if(n){n.parentChange(this,this.sParentAggregationName,"unset",this.oParent)}if(this.aAPIParentInfos&&this.aAPIParentInfos.forwardingCounter===0){delete this.aAPIParentInfos}}this.oParent=null;this.sParentAggregationName=null;var r=x;if(r!==this.oPropagatedProperties){this.oPropagatedProperties=r;if(!this._bIsBeingDestroyed){Promise.resolve().then(function(){if(!this.oParent){this.updateBindings(true,null);this.updateBindingContext(false,undefined,true);this.propagateProperties(true);this.fireModelContextChange()}}.bind(this))}}this._oContextualSettings=O;if(!this._bIsBeingDestroyed){Promise.resolve().then(function(){if(!this.oParent){this._propagateContextualSettings()}}.bind(this))}o.refresh();return}if(M(t,this)){throw new Error("Cycle detected: new parent '"+t+"' is already a descendant of (or equal to) '"+this+"'")}if(i){o.refresh();t.iSuppressInvalidate++}var s=this.getParent();if(s){s._removeChild(this,this.sParentAggregationName)}this.oParent=t;this.sParentAggregationName=e;if(!t.mSkipPropagation[e]){var r=this.aAPIParentInfos?this.aAPIParentInfos[0].parent._getPropertiesToPropagate():t._getPropertiesToPropagate();if(r!==this.oPropagatedProperties){this.oPropagatedProperties=r;if(this.hasModel()){this.updateBindings(true,null);this.updateBindingContext(false,undefined,true);this.propagateProperties(true)}this._callPropagationListener();this.fireModelContextChange()}}this._applyContextualSettings(t._oContextualSettings);if(t&&!t.isInvalidateSuppressed()){t.invalidate(this)}if(i){t.iSuppressInvalidate--}n=this._observer||this.oParent._observer;if(n){n.parentChange(this,e,"set",this.oParent)}return this};v.prototype._applyContextualSettings=function(t){t=t||O;if(this._oContextualSettings!==t){this._oContextualSettings=t;this._propagateContextualSettings();if(this._bIsOwnerActive){this._onContextualSettingsChanged()}}};v.prototype._onContextualSettingsChanged=function(){};v.prototype._propagateContextualSettings=function(){var t=this._oContextualSettings,e,i,n;for(e in this.mAggregations){i=this.mAggregations[e];if(i instanceof v){i._applyContextualSettings(t)}else if(i instanceof Array){for(n=0;n<i.length;n++){if(i[n]instanceof v){i[n]._applyContextualSettings(t)}}}}};v.prototype._getContextualSettings=function(){return this._oContextualSettings};v.prototype.getParent=function(){return this.oParent};v.prototype.destroy=function(t){var e,n;if(this.bIsDestroyed){return}var r=this;this._bIsBeingDestroyed=true;if(t){this.iSuppressInvalidate++}for(e in this.mBindingInfos){n=this.mBindingInfos[e];if(n.binding){if(n.factory){this._detachAggregationBindingHandlers(e)}else{this._detachPropertyBindingHandlers(e)}}}for(e in this.mObjectBindingInfos){n=this.mObjectBindingInfos[e];if(n.binding){this._detachObjectBindingHandlers(n)}}if(this.exit){a(this.exit(),{name:"exit",component:this.getId()})}if(this._exitCompositeSupport){this._exitCompositeSupport()}for(var s in this.mAggregations){this.destroyAggregation(s,t)}if(this.deregister){this.deregister()}if(this.oParent&&this.sParentAggregationName){this.oParent._removeChild(this,this.sParentAggregationName,t)}delete this.oParent;for(e in this.mBindingInfos){if(this.mBindingInfos[e].factory){this.unbindAggregation(e,true)}else{this.unbindProperty(e,true)}}for(e in this.mObjectBindingInfos){this.unbindObject(e,true)}if(t){this.iSuppressInvalidate--}if(this._observer){this._observer.objectDestroyed(this)}if(this.aAPIParentInfos){this.aAPIParentInfos=null}i.prototype.destroy.apply(this,arguments);this.setParent=function(){throw Error("The object with ID "+r.getId()+" was destroyed and cannot be used anymore.")};this.bIsDestroyed=true};v.prototype.isBinding=function(t,e){return typeof this.extractBindingInfo(t)==="object"};v.prototype.extractBindingInfo=function(t,e,i){var n=s.extract(t,e,i);if(typeof t==="object"&&n&&n.template){n.template=_(n.template)}return n};v.prototype.getBindingInfo=function(t){var e=this.getMetadata().getAggregationForwarder(t);if(e&&e.forwardBinding){return e.getTarget(this).getBindingInfo(e.targetAggregationName)}return this.mBindingInfos[t]};v.prototype._getObjectBindingInfo=function(t){return this.mObjectBindingInfos[t]};v.prototype.bindObject=function(t){var e;if(arguments[1]){g.fatalThrows(`${this}.bindObject: Providing 'parameters' as positional parameter is deprecated as of 1.135.0. Provide an sap.ui.base.ManagedObject.ObjectBindingInfo instead.`)}if(typeof t=="string"){t={path:t,parameters:arguments[1]}}t=s.createObject(t);e=t.model;if(this.getObjectBinding(e)){this.unbindObject(e,true)}this.mObjectBindingInfos[e]=t;if(s.isReady(t,this)){this._bindObject(t)}return this};function w(t){g.errorThrows("Unexpected call of '"+t+"'.")}v.prototype._bindObject=w.bind(null,"_bindObject");v.prototype._detachObjectBindingHandlers=w.bind(null,"_detachObjectBindingHandlers");v.prototype.unbindObject=function(t,e){var i=this.mObjectBindingInfos[t];if(i){delete this.mObjectBindingInfos[t];if(i.binding){this._unbindObject(i,t,e)}}return this};v.prototype._unbindObject=w.bind(null,"_unbindObject");v.prototype.bindContext=function(t){return this.bindObject(t)};v.prototype.unbindContext=function(t){return this.unbindObject(t)};v.prototype.bindProperty=function(t,e){var i=this.getMetadata().getPropertyLikeSetting(t);if(!i){throw new Error('Property "'+t+'" does not exist in '+this)}if(arguments[2]||arguments[3]){g.fatalThrows(`${this}.bindProperty: Providing a type, formatter, or bindingMode as a positional parameter is deprecated as of 1.135.0. Provide an sap.ui.base.ManagedObject.PropertyBindingInfo instead.`)}if(typeof e=="string"){e={parts:[{path:e,type:r.isObjectA(arguments[2],"sap.ui.model.Type")?arguments[2]:undefined,mode:arguments[3]}],formatter:typeof arguments[2]==="function"?arguments[2]:undefined}}if(this.isBound(t)){this.unbindProperty(t,true)}e=s.createProperty(e);this.mBindingInfos[t]=e;if(this._observer){this._observer.bindingChange(this,t,"prepare",e,"property")}if(s.isReady(e,this)){this._bindProperty(t,e)}return this};v.prototype._bindProperty=function(t,e){var i=true;for(var n=0;n<e.parts.length;n++){if(e.parts[n].value===undefined){i=false;break}}if(i){const i=[];let n;e.parts.forEach(function(t){i.push(t.formatter?t.formatter(t.value):t.value)});if(e.formatter){n=e.formatter(i)}else if(i.length>1){n=i.join(" ")}else{n=i[0]}var r=this.getMetadata().getPropertyLikeSetting(t);this[r._sMutator](n)}else{w.call(this,"_bindProperty")}};v.prototype._detachPropertyBindingHandlers=function(t){};v.prototype.unbindProperty=function(t,e){var i=this.mBindingInfos[t];if(i){if(i.binding){this._unbindProperty(i,t)}if(this._observer&&!this._bIsBeingDestroyed){this._observer.bindingChange(this,t,"remove",this.mBindingInfos[t],"property")}delete this.mBindingInfos[t];if(!e){this.resetProperty(t)}}return this};v.prototype._unbindProperty=w.bind(null,"_unbindProperty");v.prototype.isPropertyBeingUpdated=function(t){const e=this.getBindingInfo(t);return!!e?.skipModelUpdate};v.prototype.updateProperty=function(t){};v.prototype.updateModelProperty=function(t,e,i){};var j=1;v.prototype.bindAggregation=function(e,i,n){var r=this.getMetadata(),o=r.getAggregation(e);if(!o){throw new Error('Aggregation "'+e+'" does not exist in '+this)}if(!o.multiple){g.errorThrows('Binding of single aggregation "'+e+'" of '+this+" is not supported!")}if(arguments[3]||arguments[4]){g.fatalThrows(`${this}.bindAggregation: Providing sorters and/or filters as positional parameters is deprecated as of 1.135.0. Provide an sap.ui.base.ManagedObject.AggregationBindingInfo instead.`)}if(typeof i=="string"){i={path:i,sorter:arguments[3],filters:arguments[4]};if(n instanceof v){i.template=n}else if(typeof n==="function"){i.factory=n}}i[s.OriginalParent]??=this;var a=r.getAggregationForwarder(e);if(a&&a.forwardBinding){a.getTarget(this).bindAggregation(a.targetAggregationName,i);return this}if(this.isBound(e)){this.unbindAggregation(e)}if(i.template){if(i.template._sapui_candidateForDestroy){g.warningThrows("A binding template that is marked as 'candidate for destroy' is reused in a binding. "+"You can use 'templateShareable:true' to fix this issue for all bindings that are affected "+"(The template is used in aggregation '"+e+"' of object '"+this.getId()+"'). "+"For more information, see documentation under 'Aggregation Binding'.");delete i.template._sapui_candidateForDestroy}if(i.templateShareable===undefined){i.templateShareable=j}else if(typeof i.templateShareable==="string"){g.warningThrows(`Parameter 'templateShareable' is defined with type boolean but is set for binding template ${i.template.toString()} with string value "${i.templateShareable}". This can easily lead to errors. To avoid unintended behavior, always set the parameter to true or false`);if(i.templateShareable==="true"){i.templateShareable=true}else if(i.templateShareable==="false"){i.templateShareable=false}}}i=s.createAggregation(i,o._doesNotRequireFactory);this.mBindingInfos[e]=i;if(!(i.template||i.factory)){throw new Error("Missing template or factory function for aggregation "+e+" of "+this+" !")}if(i.factory){var p=i.factory[m]||i.factory;var f=this._sOwnerId;i.factory=function(e,i){return t(p.bind(null,e,i),f)};i.factory[m]=p}if(this._observer){this._observer.bindingChange(this,e,"prepare",i,"aggregation")}if(s.isReady(i,this)){this._bindAggregation(e,i)}return this};v.prototype._bindAggregation=w.bind(null,"_bindAggregation");v.prototype._detachAggregationBindingHandlers=w.bind(null,"_detachAggregationBindingHandlers");v.prototype.unbindAggregation=function(t,e){var i=this.getMetadata().getAggregationForwarder(t);if(i&&i.forwardBinding){i.getTarget(this).unbindAggregation(i.targetAggregationName,e);return this}var n=this.mBindingInfos[t],r=this.getMetadata().getAggregation(t);if(n){if(n.binding){this._unbindAggregation(n,t)}if(n.template){if(!n.templateShareable&&n.template.destroy){n.template.destroy()}if(n.templateShareable===j){n.template._sapui_candidateForDestroy=true}}if(this._observer&&!this._bIsBeingDestroyed){this._observer.bindingChange(this,t,"remove",this.mBindingInfos[t],"aggregation")}delete this.mBindingInfos[t];if(!e){this[r._sDestructor]()}}return this};v.prototype._unbindAggregation=w.bind(null,"_unbindAggregation");v.prototype.updateAggregation=function(t,e,i){};v.prototype.refreshAggregation=function(t){};v.prototype.propagateMessages=function(t,e){g.warningThrows("Message for "+this+", Property "+t+" received. Control "+this.getMetadata().getName()+" does not support messaging without using data binding.")};v.prototype.isTreeBinding=function(t){return false};v.prototype.updateBindings=function(t,e){};v.prototype.isBound=function(t){return!!this.getBindingInfo(t)};v.prototype.getObjectBinding=function(t){P(t);var e=this._getObjectBindingInfo(t);return e&&e.binding};v.prototype.getEventingParent=function(){return this.oParent};v.prototype.getBinding=function(t){var e=this.getBindingInfo(t);return e&&e.binding};v.prototype.getBindingPath=function(t){var e=this.getBindingInfo(t);return e&&(e.path||e.parts&&e.parts[0]&&e.parts[0].path)};v.prototype.setBindingContext=function(t,e){P(e);var i=this.oBindingContexts[e];if(i!==t||t&&t.hasChanged()){if(t===undefined){delete this.oBindingContexts[e]}else{this.oBindingContexts[e]=t}this.updateBindingContext(false,e);this.propagateProperties(e);this.fireModelContextChange()}return this};v.prototype.setElementBindingContext=function(t,e){};v.prototype.updateBindingContext=function(t,e,i){};v.prototype.getBindingContext=function(t){var e=this.getModel(t),i=this.mElementBindingContexts[t];if(i&&!e){return i}else if(i&&e&&i.getModel()===e){return i}else if(i===null){return i}else{return this._getBindingContext(t)}};v.prototype._getBindingContext=function(t){var e=this.getModel(t),i=this.oBindingContexts[t],n=this.oPropagatedProperties.oBindingContexts[t];if(i&&!e){return this.oBindingContexts[t]}else if(i&&e&&i.getModel()===e){return this.oBindingContexts[t]}else if(i===null){return i}else if(n&&e&&n.getModel()!==e){return undefined}else{return n}};v.prototype.setModel=function(t,e){d(t==null||r.isObjectA(t,"sap.ui.model.Model"),"oModel must be an instance of sap.ui.model.Model, null or undefined");d(e===undefined||typeof e==="string"&&!/^(undefined|null)?$/.test(e),"sName must be a string or omitted");if(!t&&this.oModels[e]){delete this.oModels[e];this.propagateProperties(e);this.updateBindings(false,e);this.fireModelContextChange()}else if(t&&t!==this.oModels[e]){this.oModels[e]=t;this.propagateProperties(e);this.updateBindingContext(false,e);this.updateBindings(false,e);this.fireModelContextChange()}return this};v.prototype.addPropagationListener=function(t){d(typeof t==="function","listener must be a function");this.aPropagationListeners.push(t);this.propagateProperties(false);this._callPropagationListener(t);return this};v.prototype.removePropagationListener=function(t){d(typeof t==="function","listener must be a function");var e=this.aPropagationListeners;var i=e.indexOf(t);if(i>=0){e.splice(i,1);this.propagateProperties(false)}return this};v.prototype.getPropagationListeners=function(){return this.oPropagatedProperties.aPropagationListeners.concat(this.aPropagationListeners)};v.prototype._callPropagationListener=function(t){var e;if(t){t(this)}else{e=this.getPropagationListeners();for(var i=0;i<e.length;i++){t=e[i];t(this)}}return this};const x={oModels:{},oBindingContexts:{},aPropagationListeners:[]};function S(t,e){return!e.aAPIParentInfos||e.aAPIParentInfos[0].parent===t}v.prototype.propagateProperties=function(t){var e=this._getPropertiesToPropagate(),i=t===true,n=t===false,r=i?undefined:t,s,o,a,g=Object.assign({},this.mAggregations,this.mForwardedAggregations);I(e.oModels);for(s in g){if(this.mSkipPropagation[s]){continue}o=g[s];if(o instanceof v){if(S(this,o)){this._propagateProperties(t,o,e,i,r,n)}}else if(o instanceof Array){for(a=0;a<o.length;a++){if(o[a]instanceof v){if(S(this,o[a])){this._propagateProperties(t,o[a],e,i,r,n)}}}}}};v.prototype._propagateProperties=function(t,e,i,n,r,s){if(!i){i=this._getPropertiesToPropagate();n=t===true;s=t===false;r=n?undefined:t}I(i.oModels);if(e.oPropagatedProperties!==i){e.oPropagatedProperties=i;if(s!==true){e.updateBindings(n,r);e.updateBindingContext(false,r,n)}e.propagateProperties(t);if(s||n){e._callPropagationListener()}e.fireModelContextChange()}};v.prototype._getPropertiesToPropagate=function(){var t=y(this.oModels),e=y(this.oBindingContexts),i=this.aPropagationListeners.length===0,n=y(this.mElementBindingContexts);function r(t,e,i,n){return t?e:c({},e,i,n)}function s(t,e,i){return t?e:e.concat(i)}if(e&&t&&n&&i){return this.oPropagatedProperties}else{return{oModels:r(t,this.oPropagatedProperties.oModels,this.oModels),oBindingContexts:r(e&&n,this.oPropagatedProperties.oBindingContexts,this.oBindingContexts,this.mElementBindingContexts),aPropagationListeners:s(i,this.oPropagatedProperties.aPropagationListeners,this.aPropagationListeners)}}};v.prototype.getModel=function(t){P(t);return this.oModels[t]||this.oPropagatedProperties.oModels[t]};v.prototype.getOwnModels=function(){return this.oModels};v.prototype.hasModel=function(){return!(y(this.oModels)&&y(this.oPropagatedProperties.oModels))};v.prototype.clone=function(t,e,i){var r=true,o=true;if(i){r=!!i.cloneChildren;o=!!i.cloneBindings}if(!t){t=n.uid("clone")||u()}if(!e&&r){e=this.findAggregatedObjects(true,null,true).map(function(t){return t.getId()});e.push(this.getId())}var a=this.getMetadata(),p=a._oClass,f=this.getId()+"-"+t,d={},l,c=this.mProperties,y,b,m,P=s.escape,A,I;var _=Object.keys(c);var B;A=_.length;while(A>0){y=_[--A];l=a.getProperty(y);if(l&&!(this.isBound(y)&&o)){if(typeof c[y]==="string"){d[y]=P(c[y])}else{B=l.byValue?h(c[y]):c[y];if(B&&typeof B==="object"&&!Object.isFrozen(B)){B[s.UI5ObjectMarker]=true}d[y]=B}}}d["models"]=this.oModels;d["bindingContexts"]=this.oBindingContexts;if(r){var C=Object.assign({},this.mAggregations,this.mForwardedAggregations);for(b in C){var M=C[b];if(a.hasAggregation(b)&&!(this.isBound(b)&&o)){if(M instanceof v){d[b]=M.clone(t,e)}else if(Array.isArray(M)){d[b]=[];for(var A=0;A<M.length;A++){d[b].push(M[A].clone(t,e))}}else{d[b]=typeof M==="string"?P(M):M}}}for(b in this.mAssociations){if(!a.hasAssociation(b)){continue}var w=this.mAssociations[b];if(Array.isArray(w)){w=w.slice(0);for(var A=0;A<w.length;A++){if(e.indexOf(w[A])>=0){w[A]+="-"+t}}}else if(e.indexOf(w)>=0){w+="-"+t}d[b]=w}}m=new p(f,d);function x(i,n,r,s,o){var a=!r;var p=Object.assign({},i);if(!i.templateShareable&&i.template&&i.template.clone){p.template=i.template.clone(t,e);delete p.factory}else if(i.templateShareable===j){i.templateShareable=p.templateShareable=true;g.errorThrows("During a clone operation, a template was found that neither was marked with 'templateShareable:true' nor 'templateShareable:false'. "+"The framework won't destroy the template. This could cause errors (e.g. duplicate IDs) or memory leaks "+"(The template is used in aggregation '"+o+"' of object '"+s.getId()+"')."+"For more information, see documentation under 'Aggregation Binding'.")}delete p.binding;delete p.modelChangeHandler;delete p.dataStateChangeHandler;delete p.modelRefreshHandler;if(a){n.bindObject(p)}else if(i.factory){n.bindAggregation(r,p)}else{n.bindProperty(r,p)}}for(b in this.mEventRegistry){m.mEventRegistry[b]=this.mEventRegistry[b].slice()}if(o){for(b in this.mObjectBindingInfos){x(this.mObjectBindingInfos[b],m)}for(b in this.mBindingInfos){x(this.mBindingInfos[b],m,b,this,b)}}if(v._supportInfo){v._supportInfo.addSupportInfo(m.getId(),v._supportInfo.byId(this.getId()))}if(this._cloneMetadataContexts){this._cloneMetadataContexts(m)}if(this.mForwardedAggregations){for(b in this.mForwardedAggregations){var S=m.getMetadata().getAggregationForwarder(b);if(S){I=S.getTarget(m,true);if(S.forwardBinding&&this.isBound(b)){x(this.getBindingInfo(b),I,S.targetAggregationName,this,b)}}}}return m};v.prototype.findAggregatedObjects=function(t,e,i){var n=[];if(e&&typeof e!=="function"){e=null}function r(s){var o,a,g;if(i){for(g in s.mBindingInfos){o=s.mBindingInfos[g].template;if(o){if(!e||e(o)){n.push(o)}if(t){r(o)}}}}for(g in s.mAggregations){o=s.mAggregations[g];if(Array.isArray(o)){for(a=0;a<o.length;a++){if(!e||e(o[a])){n.push(o[a])}if(t){r(o[a])}}}else if(o instanceof v){if(!e||e(o)){n.push(o)}if(t){r(o)}}}}r(this);return n};v.prototype.onOwnerDeactivation=function(){this._bIsOwnerActive=false};v.prototype.onOwnerActivation=function(){this._bIsOwnerActive=true;this._onContextualSettingsChanged()};v.prototype.isDestroyStarted=function(){return!!this._bIsBeingDestroyed};v.prototype.isDestroyed=function(){return!!this.bIsDestroyed};v.prototype.updateFieldHelp=undefined;const O={};return v});
//# sourceMappingURL=ManagedObject.js.map