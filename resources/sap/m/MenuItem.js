/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/m/library","sap/ui/core/library","sap/ui/core/Element","sap/ui/core/Control","sap/m/ResponsivePopover","sap/m/Button","sap/m/Bar","sap/m/Title","sap/m/MenuWrapper","sap/ui/core/Lib","sap/m/MenuItemRenderer","sap/ui/Device","sap/ui/core/InvisibleText","sap/base/i18n/Localization","sap/ui/core/IconPool","sap/m/Image"],function(e,t,o,n,s,i,r,a,p,u,l,c,g,h,d,_){"use strict";const f=e.PlacementType;const m=t.ItemSelectionMode;var b=t.TextDirection;const y=n.extend("sap.m.MenuItem",{metadata:{interfaces:["sap.m.IMenuItem"],library:"sap.m",properties:{text:{type:"string",group:"Data",defaultValue:""},icon:{type:"string",group:"Appearance",defaultValue:null},enabled:{type:"boolean",group:"Misc",defaultValue:true},visible:{type:"boolean",group:"Appearance",defaultValue:true},selected:{type:"boolean",group:"Behavior",defaultValue:false},shortcutText:{type:"string",group:"Appearance",defaultValue:""},startsSection:{type:"boolean",group:"Behavior",defaultValue:false},textDirection:{type:"sap.ui.core.TextDirection",group:"Misc",defaultValue:b.Inherit},key:{type:"string",group:"Data",defaultValue:null},_expanded:{type:"boolean",group:"Misc",visibility:"hidden",defaultValue:undefined}},defaultAggregation:"items",aggregations:{items:{type:"sap.m.IMenuItem",multiple:true,singularName:"item",bindable:"bindable",forwarding:{idSuffix:"-menuWrapper",aggregation:"items"}},endContent:{type:"sap.ui.core.Control",multiple:true},_icon:{type:"sap.ui.core.Control",multiple:false,visibility:"hidden"},_menuWrapper:{type:"sap.m.MenuWrapper",multiple:false,visibility:"hidden"},_popover:{type:"sap.m.ResponsivePopover",multiple:false,visibility:"hidden"}},associations:{_group:{type:"sap.m.MenuItemGroup",group:"Behavior",visibility:"hidden"}},events:{press:{}},renderer:l}});y.prototype.init=function(){const e=this._createMenuWrapper(true);this._itemSelectionMode=m.None;e.attachClosePopover(this._handleCloseRequest,this);this._openDuration=c.system.phone?null:0};y.prototype.exit=function(){const e=this._getMenuWrapper(),t=this._getPopover(),o=this.getAggregation("_icon");e.detachClosePopover(this._handleCloseRequest,this);e.destroy();if(t){t.detachAfterClose(this._afterPopoverClose,this);t.destroy()}if(o){o.destroy()}};y.prototype.onBeforeRendering=function(){let e=this._getPopover();if(this._hasSubmenu()&&!e){e=this._createPopover();e.attachAfterClose(this._afterPopoverClose,this);this._hasSubmenu()&&this.setProperty("_expanded",false)}};y.prototype.onfocusin=function(e){if(!this.isFocusable||!this.isFocusable()){e.preventDefault()}};y.prototype.setSelected=function(e){const t=o.getElementById(this.getAssociation("_group"));if(e&&t&&t.getItemSelectionMode()===m.SingleSelect){t._clearSelectedItems()}this.setProperty("selected",e);return this};y.prototype.isInteractive=function(){return true};y.prototype.isFocusable=function(){return true};y.prototype.isCountable=function(){return this.isFocusable()};y.prototype._getAccessibilityAttributes=function(){const e=this._oAccInfo||{bAccessible:false};if(!e.bAccessible){return{}}const o=this._hasSubmenu(),n=this._getMenuWrapper(),s=this.getSelected()&&this._getItemSelectionMode()!==m.None,i=!o?this.getShortcutText():null;return{role:this._getRole(),disabled:!this.getEnabled(),posinset:e["posinset"]||null,setsize:e["setsize"]||null,selected:null,checked:s||null,keyshortcuts:i||null,labelledby:{value:`${this.getId()}-txt`,append:true},haspopup:o?t.aria.HasPopup.Menu.toLowerCase():null,owns:o?n.getId():null,expanded:this.getProperty("_expanded")}};y.prototype._getRole=function(){let e;switch(this._getItemSelectionMode()){case m.SingleSelect:e="menuitemradio";break;case m.MultiSelect:e="menuitemcheckbox";break;default:e="menuitem"}return e};y.prototype._handleCloseRequest=function(e){if(!e.getParameter("bubbleToRoot")){this._closeSubmenu();e.cancelBubble()}else{this._getMenuWrapper().fireCloseItemSubmenu({item:this})}};y.prototype._closeSubmenu=function(){const e=this._getVisibleItems(),t=this._getPopover();e.forEach(e=>{if(e._hasSubmenu&&e._hasSubmenu()){e._closeSubmenu()}});if(t){t.removeStyleClass(this._getMenuWrapper()._aStyleClasses.join(" "));t._getPopup().setDurations(this._openDuration,0);t.close()}this.setProperty("_expanded",false);this.removeStyleClass("sapMMenuItemSubMenuOpen");this._getMenuWrapper().oOpenedSubmenuParent=null};y.prototype._openSubmenu=function(){if(!this.getEnabled()||!this._hasSubmenu()){return}const e=this._getMenuWrapper(),t=this._getPopover();if(t.isOpen()){return}t.addStyleClass(e._aStyleClasses.join(" "));this.setProperty("_expanded",true);if(c.system.phone){e.setTitle(this.getText());t.getCustomHeader().getContentMiddle()[0].setText(this.getText())}else{this.addStyleClass("sapMMenuItemSubMenuOpen")}t._getPopup().setDurations(this._openDuration,0);t.openBy(this)};y.prototype._getBackButtonTooltipForPageWithParent=function(){return u.getResourceBundleFor("sap.m").getText("MENU_PAGE_BACK_BUTTON")+" "+this.getText()};y.prototype._afterPopoverClose=function(){this.removeStyleClass("sapMMenuItemSubMenuOpen")};y.prototype._getItems=function(){const e=[];const t=o=>{o.forEach(o=>{if(!o.getItemSelectionMode){e.push(o)}else{t(o.getItems())}})};t(this.getItems());return e};y.prototype._getVisibleItems=function(){return this._getItems().filter(e=>e.getVisible())};y.prototype._getIcon=function(){const e=this.getIcon();let t=this.getAggregation("_icon");if(t){t.destroy()}if(!e){return null}t=d.createControlByURI({src:e,useIconTooltip:false},_);this.setAggregation("_icon",t,true);return t};y.prototype._getItemSelectionMode=function(){return this._itemSelectionMode};y.prototype._hasSubmenu=function(){return this._getVisibleItems().length>0};y.prototype._createMenuWrapper=function(e){const t=new p(this.getId()+"-menuWrapper",{isSubmenu:e});this.setAggregation("_menuWrapper",t,true);return t};y.prototype._createPopover=function(){let e=this._getPopover();if(e){return e}const t=c.system.phone?`${this.getId()}-title`:g.getStaticId("sap.m","MENU_POPOVER_ACCESSIBLE_NAME");const o=this._getMenuWrapper(),n=h.getRTL(),i=o.getIsSubmenu(),r=n?4:-4;e=new s(this.getId()+"-rp",{placement:this._getPopoverPlacement(),showHeader:false,showArrow:false,showCloseButton:false,verticalScrolling:true,horizontalScrolling:false,offsetX:i?r:0,offsetY:i?4:0,content:o,ariaLabelledBy:[t]});e.addStyleClass("sapMMenu");this.setAggregation("_popover",e,true);if(c.system.phone){e.setShowHeader(true);e.setEndButton(this._createCloseButton());e.setCustomHeader(this._createHeaderBar())}else if(i){e.getAggregation("_popup")._adaptPositionParams=function(){this._marginTop=0;this._marginLeft=0;this._marginRight=0;this._marginBottom=0;this._arrowOffset=0;this._offsets=["0 0","0 0","0 0","0 0"];this._myPositions=["begin bottom","begin top","begin top","end top"];this._atPositions=["begin top","end top","begin bottom","begin top"]}}e._oControl._getDocHeight=()=>window.innerHeight+window.scrollY;return e};y.prototype._createBackButton=function(){return new i(this.getId()+"-backbutton",{icon:"sap-icon://nav-back",tooltip:this._getBackButtonTooltipForPageWithParent(),press:e=>{this._getMenuWrapper().fireClosePopover()}})};y.prototype._createHeaderBar=function(){const e=this._getMenuWrapper(),t=new r({contentMiddle:new a(this.getId()+"-title",{text:e.getTitle()})}),o=this._getMenuWrapper().getIsSubmenu();if(o){t.addContentLeft(this._createBackButton())}return t};y.prototype._createCloseButton=function(){const e=u.getResourceBundleFor("sap.m");return new i({text:e.getText("MENU_CLOSE"),press:()=>{this._getMenuWrapper().fireClosePopover({bubbleToRoot:true})}})};y.prototype._getMenuWrapper=function(){const e=this._getPopover();return e?e.getContent()[0]:this.getAggregation("_menuWrapper")};y.prototype._getPopover=function(){return this.getAggregation("_popover")};y.prototype._getPopoverPlacement=function(){const e=this._getMenuWrapper().getIsSubmenu();if(e){const e=h.getRTL(),t=e?f.HorizontalPreferredLeft:f.HorizontalPreferredRight;return t}return f.VerticalPreferredBottom};y.prototype._setExtraContent=function(e){this._getPopover()._getPopup().setExtraContent([e])};return y});
//# sourceMappingURL=MenuItem.js.map