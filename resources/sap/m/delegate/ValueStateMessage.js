/*!
 * OpenUI5
 * (c) Copyright 2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/Device","sap/ui/base/Object","sap/ui/core/RenderManager","sap/ui/core/ValueStateSupport","sap/ui/core/Popup","sap/ui/core/library","sap/ui/thirdparty/jquery","sap/ui/dom/jquery/Aria"],function(e,t,o,a,s,n,jQuery){"use strict";var r=n.ValueState;var i=t.extend("sap.m.delegate.ValueState",{constructor:function(e){t.apply(this,arguments);this._oControl=e;this._oPopup=null;this._oMessageDomRef=null}});i.prototype.open=function(){var t=this._oControl,o=this.getPopup(),a=s.Dock,n;this._oMessageDomRef=this.createDom();if(!t||!t.getDomRef()||!o||!this._oMessageDomRef){return}var r=t.getValueState();var i=this._getValueStateText(t,r);n=jQuery(t.getDomRefForValueStateMessage());o.setContent(this._oMessageDomRef);o.close(0);o.open(this.getOpenDuration(),a.BeginTop,a.BeginBottom,t.getDomRefForValueStateMessage(),null,null,null,e.system.phone?true:s.CLOSE_ON_SCROLL);this.createFormattedTextDOM(i,this._oMessageDomRef);var u=jQuery(this._oMessageDomRef);if(n.offset().top<u.offset().top){u.addClass("sapMValueStateMessageBottom")}else{u.addClass("sapMValueStateMessageTop")}};i.prototype.close=function(){if(this._oPopup){this._oPopup.close(0)}};i.prototype.getId=function(){var e=this._oControl;if(!e){return""}return typeof e.getValueStateMessageId==="function"?e.getValueStateMessageId():e.getId()+"-message"};i.prototype.getDomRef=function(){return this._oMessageDomRef};i.prototype.getOpenDuration=function(){var e=this._oControl;if(!e){return 0}return e.iOpenMessagePopupDuration===undefined?0:e.iOpenMessagePopupDuration};i.prototype.createPopup=function(e){e=e||this.getId();if(this._oPopup){return this._oPopup}this._oPopup=new s(document.createElement("span"),false,false,false);this._oPopup.attachClosed(function(){jQuery(document.getElementById(e)).remove()});this._oPopup.attachOpened(function(){var e=this._oPopup.getContent();if(e){e.style.zIndex=this._getCorrectZIndex()}}.bind(this));return this._oPopup};i.prototype.getPopup=function(){if(!this._oControl){return null}return this.createPopup()};i.prototype._getValueStateText=function(e,t){if(t===r.Success||t===r.None){return""}var o=e.getFormattedValueStateText&&e.getFormattedValueStateText();var s=o&&o.getHtmlText();var n=e.getValueStateText()||a.getAdditionalText(e);return s?o:n};i.prototype.createDom=function(){var e=this._oControl;if(!e){return null}var t=this.getId(),o,a=document.createElement("div"),s=e.getValueState(),n=this._getValueStateText(e,s);if(s===r.Success||s===r.None){a.className="sapUiInvisibleText"}else{a.className="sapMValueStateMessage sapMValueStateMessage"+s}if(typeof n==="string"){o=document.createElement("span");o.id=t+"-text";o.appendChild(document.createTextNode(n));a.appendChild(o)}a.setAttribute("role","presentation");a.id=t;return a};i.prototype.createFormattedTextDOM=function(e,t){if(typeof e==="string"){return}(new o).getInterface().render(e,t);t.lastElementChild.setAttribute("id",this.getId()+"-text")};i.prototype.destroy=function(){if(this._oPopup){this._oPopup.destroy();this._oPopup=null}this._oControl=null};i.prototype._getCorrectZIndex=function(){var e=this._oControl.$().parents().filter(function(){var e=jQuery(this).css("z-index");return e&&e!=="auto"&&e!=="0"});if(!e.length){return 1}var t=0;e.each(function(){var e=parseInt(jQuery(this).css("z-index"));if(e>t){t=e}});return t+1};return i});
//# sourceMappingURL=ValueStateMessage.js.map