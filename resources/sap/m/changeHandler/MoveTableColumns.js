/*!
 * OpenUI5
 * (c) Copyright 2009-2025 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/fl/changeHandler/Base"],function(e){"use strict";var t={};var n="source";var r="target";var o="movedElements";var i="columns";var a="cells";var u="items";function s(t,n,r,o,i){return Promise.resolve().then(t.getAggregation.bind(t,r,a)).then(function(u){if(!u){return e.markAsNotApplicable("Aggregation cells to move not found",true)}if(o<0||o>=u.length){return e.markAsNotApplicable("Move cells in table item called with invalid index: "+o,true)}var s=u[o];return Promise.resolve().then(t.removeAggregation.bind(t,r,a,s)).then(t.insertAggregation.bind(t,r,a,s,i,n))})}function c(e,t,n,r,o,i){return Promise.resolve().then(e.getAggregation.bind(e,n,u)).then(function(n){return n.reduce(function(n,a){return n.then(function(){if(i!==a&&e.getControlType(a)!=="sap.m.GroupHeaderListItem"){return s(e,t,a,r,o)}return undefined})},Promise.resolve())})}function g(t,o,a,g){var l=a.modifier;var d=a.view;var v=a.appComponent;var f=t.getContent();var m=t.getDependentControl(n,a);var p=t.getDependentControl(r,a);var h;var b;return Promise.resolve().then(function(){return l.getAggregation(p,i)}).then(function(t){h=t;if(m!==p){return e.markAsNotApplicable("Moving columns between different tables is not yet supported",true)}return f.movedElements.reduce(function(t,n){var r;var o;var a;var f;var m;return t.then(function(){b=l.bySelector(n.selector,v,d);if(!b){m=n.selector&&n.selector.id;return e.markAsNotApplicable("The column with id: '"+m+"' stored in the change is not found and the move operation cannot be applied",true)}a=h.indexOf(b);f=n.sourceIndex;o=typeof g==="function"&&g(f);o=typeof o==="number"?o:n.targetIndex;if(a!==o){r=a}else{r=f}return l.removeAggregation(p,i,b)}).then(function(){return l.insertAggregation(p,i,b,o,d)}).then(function(){return l.getBindingTemplate(p,u)}).then(function(e){if(e){return s(l,d,e,r,o).then(function(){return c(l,d,p,r,o,e)})}else{return c(l,d,p,r,o)}})},Promise.resolve())})}t.applyChange=function(e,t,n){var r=[];return Promise.resolve().then(function(){return g(e,t,n,function(e){r.unshift({index:e})})}).then(function(){e.setRevertData(r)})};t.revertChange=function(e,t,n){var r=e.getRevertData();return Promise.resolve().then(function(){return g(e,t,n,function(){var e=r.shift();return e&&e.index})}).then(function(){e.resetRevertData()})};t.completeChangeContent=function(e,t,i){var a=i.modifier;var u=i.appComponent;var s=a.bySelector(t.source.id,u);var c=a.bySelector(t.target.id,u);var g={aggregation:t.source.aggregation,type:a.getControlType(s)};var l={aggregation:t.target.aggregation,type:a.getControlType(c)};var d={movedElements:[]};t.movedElements.forEach(function(e){var t=e.element||a.bySelector(e.id,u);d.movedElements.push({selector:a.getSelector(t,u),sourceIndex:e.sourceIndex,targetIndex:e.targetIndex})});e.setContent(d);e.addDependentControl(t.source.id,n,i,g);e.addDependentControl(t.target.id,r,i,l);e.addDependentControl(t.movedElements.map(function(e){return e.id}),o,i)};return t},true);
//# sourceMappingURL=MoveTableColumns.js.map