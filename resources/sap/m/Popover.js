/*!
 * OpenUI5
 * (c) Copyright 2009-2024 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["./Bar","./Button","./InstanceManager","./library","./Title","sap/base/i18n/Localization","sap/ui/dom/isElementCovered","sap/ui/core/Control","sap/ui/core/Popup","sap/ui/core/delegate/ScrollEnablement","sap/ui/core/theming/Parameters","sap/ui/Device","sap/ui/core/util/ResponsivePaddingsEnablement","sap/ui/core/library","sap/ui/core/Element","sap/ui/core/ResizeHandler","sap/ui/core/StaticArea","./PopoverRenderer","sap/ui/dom/containsOrEquals","sap/ui/thirdparty/jquery","sap/ui/dom/getScrollbarSize","sap/ui/events/KeyCodes","sap/base/Log","sap/base/util/clamp","sap/ui/dom/jquery/Focusable","sap/ui/dom/jquery/rect"],function(t,e,o,i,r,s,n,a,h,l,f,p,g,c,u,d,_,m,P,jQuery,v,y,C,w){"use strict";var H=i.PopupHelper;var O=c.OpenState;var B=i.PlacementType;var R=i.TitleAlignment;var b=f.get({name:"_sap_m_Popover_ArrowOffset",callback:function(t){b=parseFloat(t)}});var A=a.extend("sap.m.Popover",{metadata:{interfaces:["sap.ui.core.PopupInterface"],library:"sap.m",properties:{placement:{type:"sap.m.PlacementType",group:"Behavior",defaultValue:B.Right},showHeader:{type:"boolean",group:"Appearance",defaultValue:true},title:{type:"string",group:"Appearance",defaultValue:null},modal:{type:"boolean",group:"Behavior",defaultValue:false},offsetX:{type:"int",group:"Appearance",defaultValue:0},offsetY:{type:"int",group:"Appearance",defaultValue:0},showArrow:{type:"boolean",group:"Appearance",defaultValue:true},contentWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},contentMinWidth:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:""},contentHeight:{type:"sap.ui.core.CSSSize",group:"Dimension",defaultValue:null},enableScrolling:{type:"boolean",group:"Misc",defaultValue:true,deprecated:true},verticalScrolling:{type:"boolean",group:"Misc",defaultValue:true},horizontalScrolling:{type:"boolean",group:"Misc",defaultValue:true},bounce:{type:"boolean",group:"Behavior",defaultValue:null,deprecated:true},resizable:{type:"boolean",group:"Dimension",defaultValue:false},ariaModal:{type:"boolean",group:"Misc",defaultValue:true,visibility:"hidden"},titleAlignment:{type:"sap.m.TitleAlignment",group:"Misc",defaultValue:R.Auto},ariaRoleApplication:{type:"boolean",group:"Misc",defaultValue:false,visibility:"hidden"}},defaultAggregation:"content",aggregations:{content:{type:"sap.ui.core.Control",multiple:true,singularName:"content"},customHeader:{type:"sap.ui.core.Control",multiple:false},subHeader:{type:"sap.ui.core.Control",multiple:false},footer:{type:"sap.ui.core.Control",multiple:false},_internalHeader:{type:"sap.m.Bar",multiple:false,visibility:"hidden"},beginButton:{type:"sap.ui.core.Control",multiple:false},endButton:{type:"sap.ui.core.Control",multiple:false}},associations:{leftButton:{type:"sap.m.Button",multiple:false,deprecated:true},rightButton:{type:"sap.m.Button",multiple:false,deprecated:true},initialFocus:{type:"sap.ui.core.Control",multiple:false},ariaLabelledBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaLabelledBy"},ariaDescribedBy:{type:"sap.ui.core.Control",multiple:true,singularName:"ariaDescribedBy"}},events:{afterOpen:{parameters:{openBy:{type:"sap.ui.core.Control"}}},afterClose:{parameters:{openBy:{type:"sap.ui.core.Control"}}},beforeOpen:{parameters:{openBy:{type:"sap.ui.core.Control"}}},beforeClose:{parameters:{openBy:{type:"sap.ui.core.Control"}}}},designtime:"sap/m/designtime/Popover.designtime"},renderer:m});A._bIOS7=p.os.ios&&p.os.version>=7&&p.os.version<8&&p.browser.name==="sf";g.call(A.prototype,{header:{suffix:"intHeader"},subHeader:{selector:".sapMPopoverSubHeader .sapMIBar"},content:{suffix:"cont"},footer:{selector:".sapMPopoverFooter .sapMIBar"}});A.prototype.init=function(){this._marginTopInit=false;this._marginTop=48;this._marginLeft=10;this._marginRight=10;this._marginBottom=10;this._minDimensions={width:100,height:32};this._initialWindowDimensions={};this.oPopup=new h;this.oPopup.setShadow(true);this.oPopup.setAutoClose(true);this.oPopup.setAnimations(jQuery.proxy(this._openAnimation,this),jQuery.proxy(this._closeAnimation,this));this._placements=[B.Top,B.Right,B.Bottom,B.Left,B.Vertical,B.Horizontal,B.Auto,B.VerticalPreferedTop,B.VerticalPreferedBottom,B.HorizontalPreferedLeft,B.HorizontalPreferedRight,B.VerticalPreferredTop,B.VerticalPreferredBottom,B.HorizontalPreferredLeft,B.HorizontalPreferredRight,B.PreferredRightOrFlip,B.PreferredLeftOrFlip,B.PreferredTopOrFlip,B.PreferredBottomOrFlip];this._myPositions=["center bottom","begin center","center top","end center"];this._atPositions=["center top","end center","center bottom","begin center"];this._offsets=["0 -18","18 0","0 18","-18 0"];this._arrowOffset=18;this._followOfTolerance=32;this._scrollContentList=["sap.m.NavContainer","sap.m.Page","sap.m.ScrollContainer"];this._fnAdjustPositionAndArrow=jQuery.proxy(this._adjustPositionAndArrow,this);this._fnOrientationChange=jQuery.proxy(this._onOrientationChange,this);this._fnFollowOf=jQuery.proxy(function(t){var e=t.lastOfRect,o=t.currentOfRect;if(p.system.desktop&&this.oPopup.isTopmost()&&!this.getModal()&&n(this._getOpenByDomRef(),this.getDomRef())){this.close();return}if(!p.system.desktop||Math.abs(e.top-o.top)<=this._followOfTolerance&&Math.abs(e.left-o.left)<=this._followOfTolerance||Math.abs(e.top+e.height-o.top-o.height)<=this._followOfTolerance&&Math.abs(e.left+e.width-o.left-o.width)<=this._followOfTolerance){this.oPopup._applyPosition(this.oPopup._oLastPosition,true)}else{this.close()}},this);this.setFollowOf(true);this._initResponsivePaddingsEnablement();this._oRestoreFocusDelegate={onBeforeRendering:function(){var t=u.closestTo(document.activeElement);this._sFocusControlId=t&&t.getId()},onAfterRendering:function(){if(this._sFocusControlId&&!P(this.getDomRef(),document.activeElement)){u.getElementById(this._sFocusControlId).focus()}}};var t=this;this.oPopup._applyPosition=function(e,o){var i=this.getOpenState(),r;if(i===O.CLOSING||i===O.CLOSED){return}if(o){t._storeScrollPosition()}t._clearCSSStyles();var s=t._placements.indexOf(t.getPlacement());if(s>3&&!t._bPosCalced){t._calcPlacement();return}t._bPosCalced=false;if(t._oOpenBy instanceof u){e.of=t._getOpenByDomRef()}if(!e.of){C.warning("sap.m.Popover: in function applyPosition, the openBy element doesn't have any DOM output. "+t);return}if(!P(document.documentElement,e.of)&&e.of.id){r=jQuery(document.getElementById(e.of.id));if(r){e.of=r}else{C.warning("sap.m.Popover: in function applyPosition, the openBy element's DOM is already detached from DOM tree and can't be found again by the same id. "+t);return}}var n=jQuery(e.of).rect();var a=jQuery(t.getWithinAreaDomRef());if(o&&a.height()==t._initialWindowDimensions.height&&(n.top+n.height<=0||n.top>=a.height()||n.left+n.width<=0||n.left>=a.width())){t.close();return}var l=t.getDomRef("scroll");if(!p.system.desktop){jQuery(window).scrollLeft(0)}t._deregisterContentResizeHandler();h.prototype._applyPosition.call(this,e);t._fnAdjustPositionAndArrow();t._updateResizeHandlerPlacement();t._restoreScrollPosition();t._registerContentResizeHandler(l)};this.oPopup.close=function(e){var o=typeof e==="boolean";var i=this.getOpenState();var r=t._oOpenBy&&t._oOpenBy.getDomRef&&!!t._oOpenBy.getDomRef();if(e!==true&&(this.touchEnabled||!(this._isFocusInsidePopup()&&r))&&this.isOpen()&&!(i===O.CLOSED||i===O.CLOSING)){t.fireBeforeClose({openBy:t._oOpenBy})}t._deregisterContentResizeHandler();if(this._sTimeoutId&&arguments.length>1){clearTimeout(this._sTimeoutId);this._sTimeoutId=null;var s=arguments[1];if(typeof s=="string"&&s=="autocloseBlur"&&this._isFocusInsidePopup()){return}}h.prototype.close.apply(this,o?[]:arguments);t.removeDelegate(t._oRestoreFocusDelegate)}};A.prototype.getWithinAreaDomRef=function(){return h.getWithinAreaDomRef()};A.prototype.onBeforeRendering=function(){var t,e,o,i=this.getHorizontalScrolling(),r=this.getVerticalScrolling(),s=!i||this.isPropertyInitial("horizontalScrolling"),n=!r||this.isPropertyInitial("verticalScrolling"),h=this.getCustomHeader()||this._internalHeader;if(this.hasStyleClass("sapUiPopupWithPadding")){C.warning("Usage of CSS class 'sapUiPopupWithPadding' is deprecated. Use 'sapUiContentPadding' instead",null,"sap.m.Popover")}if(!this._initialWindowDimensions.width||!this._initialWindowDimensions.height){o=jQuery(this.getWithinAreaDomRef());this._initialWindowDimensions={width:o.width(),height:o.height()}}this._hasSingleScrollableContent();if(!i&&!r){this._forceDisableScrolling=true}else if(s&&n&&this._singleScrollableContent){this._forceDisableScrolling=true;C.info("VerticalScrolling and horizontalScrolling in sap.m.Popover with ID "+this.getId()+" has been disabled because there's scrollable content inside")}else{this._forceDisableScrolling=false}if(!this._forceDisableScrolling){if(!this._oScroller){this._oScroller=new l(this,this.getId()+"-scroll",{horizontal:i,vertical:r,callBefore:true})}else{this._oScroller.setHorizontal(i);this._oScroller.setVertical(r)}}if(this._bContentChanged){this._bContentChanged=false;t=this._getSingleNavContent();e=this._getSinglePageContent();if(t&&!this.getModal()&&!p.system.phone){t.attachEvent("afterNavigate",function(t){var e=this.getDomRef();if(e){var o=this.$().firstFocusableDomRef()||e;o.focus()}},this)}if(t||e){e=e||t.getCurrentPage();if(e&&e._getAnyHeader){this.addStyleClass("sapMPopoverWithHeaderCont")}if(t){t.attachEvent("navigate",function(t){var e=t.getParameter("to");if(e instanceof a&&e.isA("sap.m.Page")){this.$().toggleClass("sapMPopoverWithHeaderCont",!!e._getAnyHeader())}},this)}}}this._setHeaderTitle();if(!p.system.desktop){this.setResizable(false)}if(h&&h.setTitleAlignment){h.setTitleAlignment(this.getTitleAlignment())}};A.prototype.onAfterRendering=function(){var t,e,o;if(!this._marginTopInit&&this.getShowArrow()){this._marginTop=2;if(this._oOpenBy){t=jQuery(this._getOpenByDomRef());if(!(t.closest("header.sapMIBar").length>0)){e=t.closest(".sapMPage");if(e.length>0){o=e.children("header.sapMIBar");if(o.length>0){this._marginTop+=o.outerHeight()}}}this._marginTopInit=true}}this._repositionOffset()};A.prototype.exit=function(){this._removeDocumentEventListeners();this._deregisterContentResizeHandler();p.resize.detachHandler(this._fnOrientationChange);o.removePopoverInstance(this);this.removeDelegate(this._oRestoreFocusDelegate);this._oRestoreFocusDelegate=null;this._sResizeHandleClass=null;if(this.oPopup){this.oPopup.detachClosed(this._handleClosed,this);this.oPopup.destroy();this.oPopup=null}if(this._oScroller){this._oScroller.destroy();this._oScroller=null}if(this._internalHeader){this._internalHeader.destroy();this._internalHeader=null}if(this._headerTitle){this._headerTitle.destroy();this._headerTitle=null}};A.prototype.openBy=function(t,e){if(!this.getVisible()){return this}var r=this.oPopup,s=this.oPopup.getOpenState(),n=this._getInitialFocusId(),a,l,g,c;a=t.getDomRef&&t.getDomRef()||t;c=jQuery(a).closest(".sapUiSizeCompact");g=f.get({name:"_sap_m_Popover_ForceCompactArrowOffset"})||"true";b=f.get({name:"_sap_m_Popover_ArrowOffset",callback:function(t){b=parseFloat(t)}})||8;g=g==="true";this._bSizeCompact=i._bSizeCompact||!!c.length||this.hasStyleClass("sapUiSizeCompact");this._bUseCompactArrow=this._bSizeCompact||g;this._adaptPositionParams();if(s===O.OPEN||s===O.OPENING){if(this._oOpenBy===t){return this}else{var u=function(){r.detachClosed(u,this);this.openBy(t)};r.attachClosed(u,this);this._oPreviousFocus=null;this.close();return this}}if(!t){return this}if(p.support.touch){p.resize.attachHandler(this._fnOrientationChange)}if(!this._oOpenBy||t!==this._oOpenBy){this._oOpenBy=t}this._addDocumentEventListeners();this.fireBeforeOpen({openBy:this._oOpenBy});r.attachOpened(this._handleOpened,this);r.attachClosed(this._handleClosed,this);r.setInitialFocusId(n);l=this._placements.indexOf(this.getPlacement());if(l>-1){a=this._getOpenByDomRef();if(!a){C.error("sap.m.Popover id = "+this.getId()+": is opened by a control which isn't rendered yet.");return this}r.setExtraContent([t]);r.setContent(this);if(l<=3){r.setPosition(this._myPositions[l],this._atPositions[l],a,this._calcOffset(this._offsets[l]),"fit")}else{r._oPosition.of=a}var d=this;var _=function(){if(r.bIsDestroyed){return}if(r.getOpenState()===O.CLOSING){if(d._sOpenTimeout){clearTimeout(d._sOpenTimeout);d._sOpenTimeout=null}d._sOpenTimeout=setTimeout(_,150)}else{d._oPreviousFocus=h.getCurrentFocusInfo();r.open();d.addDelegate(d._oRestoreFocusDelegate,d);if(!e){o.addPopoverInstance(d)}}};_()}else{C.error(this.getPlacement()+"is not a valid value! It can only be top, right, bottom or left")}return this};A.prototype.close=function(){var t=this.oPopup.getOpenState(),e,o;if(t===O.CLOSED||t===O.CLOSING){return this}this._removeDocumentEventListeners();this.fireBeforeClose({openBy:this._oOpenBy});this.oPopup.close(true);if(this._oPreviousFocus){o=document.activeElement||{};e=this._oPreviousFocus.sFocusId===u.getActiveElement()?.getId()||this._oPreviousFocus.sFocusId===o.id;if(!e){h.applyFocusInfo(this._oPreviousFocus);this._oPreviousFocus=null}}return this};A.prototype.isOpen=function(){return this.oPopup&&this.oPopup.isOpen()};A.prototype.setFollowOf=function(t){if(t){this.oPopup.setFollowOf(this._fnFollowOf)}else{this.oPopup.setFollowOf(false)}return this};A.prototype._clearCSSStyles=function(){if(!this.getDomRef()){return}var t=this.getDomRef().style,e=this.$("cont"),o=e.children(".sapMPopoverScroll"),i=e[0].style,r=o[0].style,s=this.getContentWidth(),n=this.getContentHeight(),a=this.$("arrow"),h,l,f=jQuery(this.getWithinAreaDomRef());if(s.indexOf("%")>0){h=f.width();s=H.calcPercentageSize(s,h)}if(n.indexOf("%")>0){l=f.height();n=H.calcPercentageSize(n,l)}i.width=s||"";i.height=n||"";i.maxWidth="";i.maxHeight="";t.left="";t.right="";t.top="";t.bottom="";t.width=this.isResized()&&s?s:"";t.height="";r.width="";r.display="";a.removeClass("sapMPopoverArrRight sapMPopoverArrLeft sapMPopoverArrDown sapMPopoverArrUp sapMPopoverCrossArr sapMPopoverFooterAlignArr sapMPopoverHeaderAlignArr sapContrast sapContrastPlus");a.css({left:"",top:""})};A.prototype._onOrientationChange=function(){var t=this.oPopup&&this.oPopup.getOpenState()||{};if(t!==O.OPEN&&t!==O.OPENING){return}this.oPopup._applyPosition(this.oPopup._oLastPosition,true);this._includeScrollWidth()};A.prototype._includeScrollWidth=function(){var t=this.getContentWidth(),e=this.$(),o=Math.floor(window.innerWidth*.9),i=this.$("cont");if(!i[0]){return}if(p.system.desktop&&!p.browser.chrome){var r=i[0].clientHeight<i[0].scrollHeight;if(r&&(!t||t==="auto")&&i.width()<o){e.addClass("sapMPopoverVerticalScrollIncluded")}else{e.removeClass("sapMPopoverVerticalScrollIncluded")}}};A.prototype._handleOpened=function(){var t=this;this.oPopup.detachOpened(this._handleOpened,this);if(!p.support.touch){setTimeout(function(){!t.bIsDestroyed&&p.resize.attachHandler(t._fnOrientationChange)},0)}var e=this._getInitialFocusId(),o=u.getElementById(e),i=e?window.document.getElementById(e):null;if(o&&o.getFocusDomRef()){o.getFocusDomRef().focus()}else if(!o&&i){i.focus()}this.fireAfterOpen({openBy:this._oOpenBy})};A.prototype._handleClosed=function(){this.oPopup.detachClosed(this._handleClosed,this);p.resize.detachHandler(this._fnOrientationChange);o.removePopoverInstance(this);if(!this.oPopup._bModal&&!p.system.desktop&&document.activeElement&&!jQuery(document.activeElement).is(":visible")){document.activeElement.blur()}this.fireAfterClose({openBy:this._oOpenBy})};A.prototype.onfocusin=function(t){var e=t.target,o=this.$(),i=this.getId()+"-firstfe",r=this.getId()+"-middlefe",s=this.getId()+"-lastfe";if(e.id===i){var n=o.lastFocusableDomRef();if(n){n.focus()}else{document.getElementById(r).focus()}}else if(e.id===s){var a=o.firstFocusableDomRef();if(a){a.focus()}else{document.getElementById(r).focus()}}};A.prototype.onkeydown=function(t){var e=y,o=t.which||t.keyCode,i=t.altKey;this._isSpacePressed=this._isSpacePressed||e.SPACE===o;if(!this._isSpacePressed&&o===e.ESCAPE||i&&o===e.F4){if(t.originalEvent&&t.originalEvent._sapui_handledByControl){return}this.close();t.stopPropagation();t.preventDefault()}};A.prototype.onkeyup=function(t){var e=y,o=t.which||t.keyCode;if(e.SPACE===o){this._isSpacePressed=false}};A.prototype._getResizeHandlePlacement=function(){switch(this._getCalculatedPlacement()){case B.Left:if(this.getOffsetY()>0){return"BottomLeft"}return"TopLeft";case B.Right:if(this.getOffsetY()<0){return"TopRight"}return"BottomRight";case B.Bottom:if(!this.getShowArrow()){return"BottomRight"}if(this.getOffsetX()<0){return"BottomLeft"}return"BottomRight";case B.Top:default:if(!this.getShowArrow()){return"TopRight"}if(this.getOffsetX()<0){return"TopLeft"}return"TopRight"}};A.prototype.onmousedown=function(t){if(!t.target.closest(".sapMPopoverResizeHandle")){return}const e=jQuery(document);const o=this.$();const i=this.$("cont");const r=i.height();const s=this.$("arrow");const n=this.$("scroll");const a=this._getCalculatedPlacement();const h=this._getPositionParams(o,s,i,n);const l=this._getContentDimensionsCss(h);o.addClass("sapMPopoverResizing");t.preventDefault();t.stopPropagation();const f={x:t.pageX,y:t.pageY,width:o.width(),height:r,maxWidth:parseFloat(l["max-width"]),maxHeight:parseFloat(l["max-height"]),footerHeaderHeight:o.height()-r,offsetX:this.getOffsetX(),offsetY:this.getOffsetY(),left:parseFloat(o.css("left")),top:parseFloat(o.css("top")),posParams:this._recalculateMargins(a,h)};const p=this.oPopup.getAutoClose();this.oPopup.setAutoClose(false);e.on("mousemove.sapMPopover",t=>{this._resize(f,t)});e.on("mouseup.sapMPopover",()=>{o.removeClass("sapMPopoverResizing");e.off("mouseup.sapMPopover, mousemove.sapMPopover");if(this.oPopup){this.oPopup.setAutoClose(p)}})};A.prototype._resize=function(t,e){this._resized=true;const o=this._getCalculatedPlacement();const i=this._getResizeHandlePlacement();const r=t.posParams;const n=r._fWithinAreaWidth;const a=r._fWithinAreaHeight;let h;let l;let f;let p;let g;let c;let u;if(s.getRTL()){h=t.x-e.pageX;l=t.y-e.pageY;u=r._fPopoverMarginRight}else{u=r._fPopoverMarginLeft;h=e.pageX-t.x;l=t.y-e.pageY}if(!this.getShowArrow()&&(o===B.Top||o===B.Bottom)){if(o===B.Bottom){l=-l}this.setContentWidth(Math.max(t.width+h,this._minDimensions.width)+"px");this.setContentHeight(Math.max(t.height+l,this._minDimensions.height)+"px");return}switch(o){case B.Top:p=Math.max(t.height+l,this._minDimensions.height);if(i==="TopRight"){f=w(t.width+h,this._minDimensions.width,n-t.left);g=Math.max(0,t.offsetX+(f-t.width)/2)}else{f=w(t.width-h,this._minDimensions.width,t.width+t.left-u);g=Math.min(-1,t.offsetX+(t.width-f)/2)}this.setOffsetX(Math.round(g));break;case B.Bottom:p=Math.max(t.height-l,this._minDimensions.height);if(i==="BottomRight"){f=w(t.width+h,this._minDimensions.width,n-t.left);g=Math.max(0,t.offsetX+(f-t.width)/2)}else{f=w(t.width-h,this._minDimensions.width,t.width+t.left-u);g=Math.min(-1,t.offsetX+(t.width-f)/2)}this.setOffsetX(Math.round(g));break;case B.Left:f=w(t.width-h,this._minDimensions.width,t.width+t.left-u);if(i==="TopLeft"){p=w(t.height+l,this._minDimensions.height,t.height+t.top-r._fPopoverMarginTop);c=Math.min(0,t.offsetY+(t.height-p)/2)}else{p=w(t.height-l,this._minDimensions.height,a-t.footerHeaderHeight-t.top);c=Math.max(1,t.offsetY+(p-t.height)/2)}this.setOffsetY(Math.round(c));break;case B.Right:f=w(t.width+h,this._minDimensions.width,n-t.left-this._marginRight);if(i==="TopRight"){p=w(t.height+l,this._minDimensions.height,t.height+t.top-r._fPopoverMarginTop);c=Math.min(-1,t.offsetY+(t.height-p)/2)}else{p=w(t.height-l,this._minDimensions.height,a-t.footerHeaderHeight-t.top);c=Math.max(0,t.offsetY+(p-t.height)/2)}this.setOffsetY(Math.round(c));break}this.setContentWidth(`${f}px`);this.setContentHeight(`${p}px`);this._calcPlacement()};A.prototype.isResized=function(){return this._resized};A.prototype._hasSingleNavContent=function(){return!!this._getSingleNavContent()};A.prototype._getSingleNavContent=function(){var t=this._getAllContent();while(t.length===1&&t[0]instanceof a&&t[0].isA("sap.ui.core.mvc.View")){t=t[0].getContent()}if(t.length===1&&t[0]instanceof a&&t[0].isA("sap.m.NavContainer")){return t[0]}else{return null}};A.prototype._getSinglePageContent=function(){var t=this._getAllContent();while(t.length===1&&t[0]instanceof a&&t[0].isA("sap.ui.core.mvc.View")){t=t[0].getContent()}if(t.length===1&&t[0]instanceof a&&t[0].isA("sap.m.Page")){return t[0]}else{return null}};A.prototype._hasSinglePageContent=function(){var t=this._getAllContent();while(t.length===1&&t[0]instanceof a&&t[0].isA("sap.ui.core.mvc.View")){t=t[0].getContent()}if(t.length===1&&t[0]instanceof a&&t[0].isA("sap.m.Page")){return true}else{return false}};A.prototype._hasSingleScrollableContent=function(){var t=this._getAllContent();while(t.length===1&&t[0]instanceof a&&t[0].isA("sap.ui.core.mvc.View")){t=t[0].getContent()}if(t.length===1&&t[0]instanceof a&&t[0].isA(this._scrollContentList)){this._singleScrollableContent=true}else{this._singleScrollableContent=false}};A.prototype._getOffsetX=function(){var t=this.getPlacement(),e=0;if(this._bHorizontalFlip){var o=this._getOpenByDomRef();var i=o!==undefined;var r=i?o.getBoundingClientRect().width:0;e=t===B.PreferredRightOrFlip?Math.abs(r):-Math.abs(r)}var n=s.getRTL();var a=e*(n?-1:1)+this.getOffsetX()*(n?-1:1);return a};A.prototype._getOffsetY=function(){var t=this.getPlacement(),e=0;if(this._bVerticalFlip){var o=this._getOpenByDomRef();var i=o!==undefined;var r=i?o.getBoundingClientRect().height:0;e=t==="PreferredTopOrFlip"?-Math.abs(r):Math.abs(r)}return e+this.getOffsetY()};A.prototype._calcOffset=function(t){var e=this._getOffsetX(),o=this._getOffsetY();var i=t.split(" ");return parseInt(i[0])+e+" "+(parseInt(i[1])+o)};A.prototype._calcPlacement=function(){var t=this.getPlacement();var e=this._getOpenByDomRef();switch(t){case B.Auto:this._calcAuto();break;case B.Vertical:case B.VerticalPreferedTop:case B.VerticalPreferredTop:case B.VerticalPreferedBottom:case B.VerticalPreferredBottom:case B.PreferredTopOrFlip:case B.PreferredBottomOrFlip:this._calcVertical();break;case B.Horizontal:case B.HorizontalPreferedLeft:case B.HorizontalPreferredLeft:case B.HorizontalPreferedRight:case B.HorizontalPreferredRight:case B.PreferredRightOrFlip:case B.PreferredLeftOrFlip:this._calcHorizontal();break}this._bPosCalced=true;var o=this._placements.indexOf(this._oCalcedPos);this.oPopup.setPosition(this._myPositions[o],this._atPositions[o],e,this._calcOffset(this._offsets[o]),"fit")};A.prototype._getDocHeight=function(){var t=document.body,e=document.documentElement,o=this.getWithinAreaDomRef(),i=o!==window?jQuery(o).offset():{top:0};return i.top+Math.max(t.scrollHeight,t.offsetHeight,e.clientHeight,e.offsetHeight)};A.prototype._calcVertical=function(){var t=jQuery(this._getOpenByDomRef());var e=t[0]!==undefined;var o=this.getPlacement()===B.VerticalPreferedTop||this.getPlacement()===B.VerticalPreferredTop;var i=this.getPlacement()===B.VerticalPreferedBottom||this.getPlacement()===B.VerticalPreferredBottom;var r=this.getPlacement()===B.PreferredTopOrFlip;var s=this.getPlacement()===B.PreferredBottomOrFlip;var n=e?t[0].getBoundingClientRect().top:0;var a=e?t[0].getBoundingClientRect().height:0;var h=this._getOffsetY();var l=n-this._marginTop+h;var f=this.$().outerHeight();var p=this._getDocHeight()-(t.offset().top+a+this._marginBottom+h);if(o&&l>f+this._arrowOffset){this._bVerticalFlip=false;this._oCalcedPos=B.Top}else if(r){if(l>f+this._arrowOffset){this._bVerticalFlip=false;this._oCalcedPos=B.Top}else{this._bVerticalFlip=true;this._oCalcedPos=B.Bottom}}else if(i&&p>f+this._arrowOffset){this._oCalcedPos=B.Bottom;this._bVerticalFlip=false}else if(s){if(p>f+this._arrowOffset){this._bVerticalFlip=false;this._oCalcedPos=B.Bottom}else{this._bVerticalFlip=true;this._oCalcedPos=B.Top}}else if(l>p){this._oCalcedPos=B.Top}else{this._oCalcedPos=B.Bottom}};A.prototype._calcHorizontal=function(){var t=jQuery(this._getOpenByDomRef());var e=t[0]!==undefined;var o=this.getPlacement()===B.HorizontalPreferedLeft||this.getPlacement()===B.HorizontalPreferredLeft;var i=this.getPlacement()===B.HorizontalPreferedRight||this.getPlacement()===B.HorizontalPreferredRight;var r=e?t[0].getBoundingClientRect().left:0;var n=e?t[0].getBoundingClientRect().width:0;var a=this._getOffsetX();var h=r-this._marginLeft+a;var l=r+n;var f=jQuery(this.getWithinAreaDomRef());var p=f.width()-l-this._marginRight-a;var g=this.$().outerWidth();var c=this.getPlacement()===B.PreferredLeftOrFlip;var u=this.getPlacement()===B.PreferredRightOrFlip;var d=s.getRTL();if(o&&h>g+this._arrowOffset){this._bHorizontalFlip=false;this._oCalcedPos=d?B.Right:B.Left}else if(c){if(h>g+this._arrowOffset){this._bHorizontalFlip=false;this._oCalcedPos=d?B.Right:B.Left}else{this._bHorizontalFlip=true;this._oCalcedPos=d?B.Left:B.Right}}else if(i&&p>g+this._arrowOffset){this._bHorizontalFlip=false;this._oCalcedPos=d?B.Left:B.Right}else if(u){if(p>g+this._arrowOffset){this._bHorizontalFlip=false;this._oCalcedPos=d?B.Left:B.Right}else{this._bHorizontalFlip=true;this._oCalcedPos=d?B.Right:B.Left}}else if(h>p){this._oCalcedPos=d?B.Right:B.Left}else{this._oCalcedPos=d?B.Left:B.Right}};A.prototype._calcAuto=function(){var t=jQuery(this.getWithinAreaDomRef());if(t.width()>t.height()){if(this._checkHorizontal()){this._calcHorizontal()}else if(this._checkVertical()){this._calcVertical()}else{this._calcBestPos()}}else if(this._checkVertical()){this._calcVertical()}else if(this._checkHorizontal()){this._calcHorizontal()}else{this._calcBestPos()}};A.prototype._checkHorizontal=function(){var t=jQuery(this._getOpenByDomRef());var e=t[0]!==undefined;var o=e?t[0].getBoundingClientRect().left:0;var i=e?t[0].getBoundingClientRect().width:0;var r=this._getOffsetX();var s=o-this._marginLeft+r;var n=o+i;var a=jQuery(this.getWithinAreaDomRef());var h=a.width()-n-this._marginRight-r;var l=this.$();var f=l.outerWidth()+this._arrowOffset;if(f<=s||f<=h){return true}};A.prototype._checkVertical=function(){var t=jQuery(this._getOpenByDomRef());var e=t[0]!==undefined;var o=e?t[0].getBoundingClientRect().top:0;var i=e?t[0].getBoundingClientRect().height:0;var r=this._getOffsetY();var s=o-this._marginTop+r;var n=this._getDocHeight()-t.offset().top-i-this._marginBottom-r;var a=this.$();var h=a.outerHeight()+this._arrowOffset;if(h<=s||h<=n){return true}};A.prototype._calcBestPos=function(){var t=this.$();var e=t.outerHeight();var o=t.outerWidth();var i=s.getRTL();var r=jQuery(this._getOpenByDomRef());var n=r[0]!==undefined;var a=n?r[0].getBoundingClientRect().left:0;var h=n?r[0].getBoundingClientRect().top:0;var l=n?r[0].getBoundingClientRect().width:0;var f=n?r[0].getBoundingClientRect().height:0;var p=this._getOffsetX();var g=this._getOffsetY();var c=h-this._marginTop+g;var u=this._getDocHeight()-r.offset().top-f-this._marginBottom-g;var d=a-this._marginLeft+p;var _=a+l;var m=jQuery(this.getWithinAreaDomRef());var P=m.width()-_-this._marginRight-p;var v=e*o;var y;var C;if(m.height()-this._marginTop-this._marginBottom>=e){y=e}else{y=m.height()-this._marginTop-this._marginBottom}if(m.width()-this._marginLeft-this._marginRight>=o){C=o}else{C=m.width()-this._marginLeft-this._marginRight}var w=y*d/v;var H=y*P/v;var O=C*c/v;var R=C*u/v;var b=Math.max(w,H);var A=Math.max(O,R);if(b>A){if(b===w){this._oCalcedPos=i?B.Right:B.Left}else if(b===H){this._oCalcedPos=i?B.Left:B.Right}}else if(A>b){if(A===O){this._oCalcedPos=B.Top}else if(A===R){this._oCalcedPos=B.Bottom}}else if(A===b){if(m.height()>m.width()){if(A===O){this._oCalcedPos=B.Top}else if(A===R){this._oCalcedPos=B.Bottom}}else{if(b===w){this._oCalcedPos=i?B.Right:B.Left}else if(b===H){this._oCalcedPos=i?B.Left:B.Right}}}};A.outerWidth=function(t,e){if(typeof window.SVGElement!=="undefined"&&t instanceof window.SVGElement){return t.getBoundingClientRect().width}return jQuery(t).outerWidth(!!e)};A.outerHeight=function(t,e){if(typeof window.SVGElement!=="undefined"&&t instanceof window.SVGElement){return t.getBoundingClientRect().height}return jQuery(t).outerHeight(!!e)};A.prototype._getPositionParams=function(t,e,o,i){var r=window.getComputedStyle(t[0]),s=window.getComputedStyle(o[0]),n=jQuery(window),a=this.getDomRef().clientHeight!==this.getDomRef().scrollHeight?v().width:0,h=jQuery(this.getWithinAreaDomRef()),l=h[0]!==window?h.offset():{top:0,left:0},f={};f._$popover=t;f._$parent=jQuery(this._getOpenByDomRef());f._$arrow=e;f._$content=o;f._$scrollArea=i;f._$header=t.children(".sapMPopoverHeader");f._$subHeader=t.children(".sapMPopoverSubHeader");f._$footer=t.children(".sapMPopoverFooter");f._fWindowTop=n.scrollTop();f._fWindowRight=n.width();f._fWindowBottom=A._bIOS7&&p.orientation.landscape&&window.innerHeight?window.innerHeight:n.height();f._fWindowLeft=n.scrollLeft();f._fWindowWidth=window.innerWidth;f._fWindowHeight=window.innerHeight;f._fWithinAreaWidth=Math.min(h.outerWidth(),f._fWindowWidth);f._fWithinAreaHeight=Math.min(h.outerHeight(),f._fWindowHeight);f._fDocumentWidth=f._fWindowLeft+f._fWindowRight;f._fDocumentHeight=f._fWindowTop+f._fWindowBottom;f._fArrowHeight=e.outerHeight(true);f._fPopoverWidth=A.outerWidth(t[0]);f._fPopoverInnerWidth=f._$scrollArea?f._$scrollArea.width()+a:0;f._fPopoverHeight=A.outerHeight(t[0]);f._fHeaderHeight=f._$header.length>0?f._$header.outerHeight(true):0;f._fSubHeaderHeight=f._$subHeader.length>0?f._$subHeader.outerHeight(true):0;f._fFooterHeight=f._$footer.length>0?f._$footer.outerHeight(true):0;f._fPopoverOffset=t.offset();f._fPopoverOffsetX=this._getOffsetX();f._fPopoverOffsetY=this._getOffsetY();f._fPopoverMarginTop=f._fWindowTop+this._marginTop+l.top;f._fPopoverMarginLeft=f._fWindowLeft+this._marginLeft+l.left;f._fPopoverMarginRight=f._fWindowWidth-l.left-f._fWithinAreaWidth+this._marginRight;f._fPopoverMarginBottom=f._fWindowHeight-l.top-f._fWithinAreaHeight+this._marginBottom;f._fPopoverBorderTop=parseFloat(r.borderTopWidth);f._fPopoverBorderRight=parseFloat(r.borderRightWidth);f._fPopoverBorderBottom=parseFloat(r.borderBottomWidth);f._fPopoverBorderLeft=parseFloat(r.borderLeftWidth);f._fContentMarginTop=parseFloat(s.marginTop);f._fContentMarginBottom=parseFloat(s.marginBottom);return f};A.prototype._recalculateMargins=function(t,e){var o;var i=s.getRTL();switch(t){case B.Left:if(i){e._fPopoverMarginLeft=e._$parent.offset().left+A.outerWidth(e._$parent[0],false)+this._arrowOffset-e._fPopoverOffsetX}else{e._fPopoverMarginRight=e._fWindowWidth-e._$parent.offset().left+this._arrowOffset-e._fPopoverOffsetX}break;case B.Right:if(i){e._fPopoverMarginRight=e._fWindowWidth-A.outerWidth(e._$parent[0],false)-e._$parent.offset().left+this._arrowOffset}else{e._fPopoverMarginLeft=e._$parent.offset().left+A.outerWidth(e._$parent[0],false)+this._arrowOffset+e._fPopoverOffsetX}break;case B.Top:o=e._fWindowHeight-e._$parent.offset().top+this._arrowOffset-e._fPopoverOffsetY;e._fPopoverMarginBottom=o>e._fPopoverMarginBottom?o:e._fPopoverMarginBottom;break;case B.Bottom:e._fPopoverMarginTop=e._$parent.offset().top+A.outerHeight(e._$parent[0],false)+this._arrowOffset+e._fPopoverOffsetY;break}return e};A.prototype._getPopoverPositionCss=function(t){var e,o,i,r,n=t._fDocumentWidth-t._fPopoverOffset.left-t._fPopoverWidth,a=t._fDocumentHeight-t._fPopoverOffset.top-t._fPopoverHeight,h=t._fDocumentWidth-t._fPopoverMarginRight-t._fPopoverMarginLeft<t._fPopoverWidth,l=t._fDocumentHeight-t._fPopoverMarginTop-t._fPopoverMarginBottom<t._fPopoverHeight,f=t._fPopoverOffset.left<t._fPopoverMarginLeft,p=this.getVerticalScrolling()&&t._fPopoverWidth!==t._fPopoverInnerWidth?v().width:0,g=n<t._fPopoverMarginRight+p,c=t._fPopoverOffset.top<t._fPopoverMarginTop,u=a<t._fPopoverMarginBottom,d=s.getRTL();if(h){e=t._fPopoverMarginLeft;o=t._fPopoverMarginRight}else if(f){e=t._fPopoverMarginLeft;if(d){o=""}}else if(g){o=t._fPopoverMarginRight;e=""}if(l){i=t._fPopoverMarginTop;r=t._fPopoverMarginBottom}else if(c){i=t._fPopoverMarginTop}else if(u){r=t._fPopoverMarginBottom;i=""}var _={top:i,bottom:r-t._fWindowTop,left:e,right:typeof o==="number"?o-t._fWindowLeft:o};return _};A.prototype._getContentDimensionsCss=function(t){var e={},o=t._$content[0].getBoundingClientRect().height,i=this._getMaxContentWidth(t),r=this._getMaxContentHeight(t);r=Math.max(r,0);e["max-width"]=i+"px";if(this.getContentHeight()||o>r){e["height"]=Math.min(r,o)+"px"}else{e["height"]="";e["max-height"]=r+"px"}return e};A.prototype._getMaxContentWidth=function(t){var e=t._fPopoverBorderLeft+t._fPopoverBorderRight;return t._fDocumentWidth-t._fPopoverMarginLeft-t._fPopoverMarginRight-e};A.prototype._getMaxContentHeight=function(t){var e=t._fHeaderHeight+t._fSubHeaderHeight+t._fFooterHeight+t._fContentMarginTop+t._fContentMarginBottom+t._fPopoverBorderTop+t._fPopoverBorderBottom;return t._fDocumentHeight-t._fPopoverMarginTop-t._fPopoverMarginBottom-e};A.prototype._isHorizontalScrollbarNeeded=function(t){return this.getHorizontalScrolling()&&t._$scrollArea.outerWidth(true)<=t._$content.width()};A.prototype._getArrowOffsetCss=function(t,e){var o,i=s.getRTL();e._fPopoverWidth=e._$popover.outerWidth();e._fPopoverHeight=e._$popover.outerHeight();if(t===B.Left||t===B.Right){o=e._$parent.offset().top-e._$popover.offset().top-e._fPopoverBorderTop+e._fPopoverOffsetY+.5*(A.outerHeight(e._$parent[0],false)-e._$arrow.outerHeight(false));o=Math.max(o-this._getOffsetY(),b);o=Math.min(o,e._fPopoverHeight-b-e._$arrow.outerHeight());return{top:o}}else if(t===B.Top||t===B.Bottom){if(i){o=e._$popover.offset().left+A.outerWidth(e._$popover[0],false)-(e._$parent.offset().left+A.outerWidth(e._$parent[0],false))+e._fPopoverBorderRight+e._fPopoverOffsetX+.5*(A.outerWidth(e._$parent[0],false)-e._$arrow.outerWidth(false));o=Math.max(o-this._getOffsetX(),b);o=Math.min(o,e._fPopoverWidth-b-e._$arrow.outerWidth(false));return{right:o}}else{o=e._$parent.offset().left-e._$popover.offset().left-e._fPopoverBorderLeft+e._fPopoverOffsetX+.5*(A.outerWidth(e._$parent[0],false)-e._$arrow.outerWidth(false));o=Math.max(o-this._getOffsetX(),b);o=Math.min(o,e._fPopoverWidth-b-e._$arrow.outerWidth(false));return{left:o}}}};A.prototype._getArrowPositionCssClass=function(t){switch(t){case B.Left:return"sapMPopoverArrRight";case B.Right:return"sapMPopoverArrLeft";case B.Top:return"sapMPopoverArrDown";case B.Bottom:return"sapMPopoverArrUp"}};A.prototype._getArrowStyleCssClass=function(t){var e=t._$arrow.position(),o=t._$footer.position(),i=this._getSingleNavContent(),r=this._getSinglePageContent(),s=0;if(i||r){r=r||i.getCurrentPage();if(r){s=r._getAnyHeader().$().outerHeight()}}if(e.top+t._fArrowHeight<t._fHeaderHeight+t._fSubHeaderHeight||e.top+t._fArrowHeight<s){return"sapMPopoverHeaderAlignArr"}else if(e.top<t._fHeaderHeight+t._fSubHeaderHeight||e.top<s||t._$footer.length&&e.top+t._fArrowHeight>o.top&&e.top<o.top){return"sapMPopoverCrossArr"}else if(t._$footer.length&&e.top>o.top){return"sapMPopoverFooterAlignArr"}};A.prototype._getCalculatedPlacement=function(){return this._oCalcedPos||this.getPlacement()};A.prototype._adjustPositionAndArrow=function(){var t=this.oPopup.getOpenState();if(!(t===O.OPEN||t===O.OPENING)){return}this._beforeAdjustPositionAndArrowHook();var e=this.$(),o=this.$("arrow"),i=this.$("cont"),r=this.$("scroll"),s=this._getCalculatedPlacement(),n=this._getPositionParams(e,o,i,r);n=this._recalculateMargins(s,n);var a=this._getPopoverPositionCss(n),h=this._getContentDimensionsCss(n),l=this._isHorizontalScrollbarNeeded(n);e.css(a);i.css(h);if(l){r.css("display","block")}if(this.getShowArrow()){var f=this._getArrowOffsetCss(s,n),p=this._getArrowPositionCssClass(s),g,c;o.removeAttr("style");o.css(f);o.addClass(p);if(s===B.Top&&n._$footer&&n._$footer.length){c=true}if(s===B.Left||s===B.Right){g=this._getArrowStyleCssClass(n);if(g){o.addClass(g);if(g==="sapMPopoverFooterAlignArr"){c=true}}}if(c){o.addClass("sapContrast sapContrastPlus")}}this._afterAdjustPositionAndArrowHook()};A.prototype._updateResizeHandlerPlacement=function(){if(!this.getResizable()){return}const t=this.getDomRef();const e=`sapMPopoverResizeHandle${this._getResizeHandlePlacement()}`;if(this._sResizeHandleClass){t.classList.remove(this._sResizeHandleClass)}t.classList.add(e);this._sResizeHandleClass=e};A.prototype._adaptPositionParams=function(){if(this.getShowArrow()){this._marginLeft=10;this._marginRight=10;this._marginBottom=10;this._arrowOffset=18;this._offsets=["0 -18","18 0","0 18","-18 0"];if(this._bUseCompactArrow){this._arrowOffset=9;this._offsets=["0 -9","9 0","0 9","-9 0"]}this._myPositions=["center bottom","begin center","center top","end center"];this._atPositions=["center top","end center","center bottom","begin center"]}else{this._marginTop=0;this._marginLeft=0;this._marginRight=0;this._marginBottom=0;this._arrowOffset=0;this._offsets=["0 0","0 0","0 0","0 0"];this._myPositions=["begin bottom","begin center","begin top","end center"];this._atPositions=["begin top","end center","begin bottom","begin center"]}};A.prototype._afterAdjustPositionAndArrowHook=function(){};A.prototype._beforeAdjustPositionAndArrowHook=function(){};A.prototype._isPopupElement=function(t){var e=this._getOpenByDomRef();return!!jQuery(t).closest(_.getDomRef()).length||!!jQuery(t).closest(e).length};A.prototype._getAnyHeader=function(){if(this.getCustomHeader()){return this.getCustomHeader()}else if(this.getShowHeader()){this._createInternalHeader();return this._internalHeader}};A.prototype._createInternalHeader=function(){if(!this._internalHeader){var e=this;this._internalHeader=new t(this.getId()+"-intHeader",{titleAlignment:this.getTitleAlignment()});this.setAggregation("_internalHeader",this._internalHeader);this._internalHeader.addEventDelegate({onAfterRendering:function(){e._restoreFocus()}});return true}else{return false}};A.prototype._animation=function(t,e){var o=null;var i=function(){e.off("webkitTransitionEnd transitionend");clearTimeout(o);setTimeout(function(){t()})};e.on("webkitTransitionEnd transitionend",i);o=setTimeout(i,this._getAnimationDuration())};A.prototype._getAnimationDuration=function(){return 300};A.prototype._openAnimation=function(t,e,o){var i=this;setTimeout(function(){t.css("display","block");i._includeScrollWidth();i._animation(function(){if(!i.oPopup||i.oPopup.getOpenState()!==O.OPENING){return}o()},t)},p.browser.firefox?50:0)};A.prototype._closeAnimation=function(t,e,o){t.addClass("sapMPopoverTransparent");this._animation(function(){o();t.removeClass("sapMPopoverTransparent")},t)};A.prototype._getInitialFocusId=function(){return this.getInitialFocus()||this._getFirstVisibleButtonId()||this._getFirstFocusableContentElementId()||this.getId()};A.prototype._getFirstVisibleButtonId=function(){var t=this.getBeginButton(),e=this.getEndButton(),o="";if(t&&t.getVisible()&&t.getEnabled()){o=t.getId()}else if(e&&e.getVisible()&&e.getEnabled()){o=e.getId()}return o};A.prototype._getFirstFocusableContentElementId=function(){var t="";var e=this.$("cont");var o=e.firstFocusableDomRef();if(o){t=o.id}return t};A.prototype._restoreFocus=function(){if(this.isOpen()){var t=this._getInitialFocusId(),e=u.getElementById(t),o=t?window.document.getElementById(t):null;if(e&&e.getFocusDomRef()){e.getFocusDomRef().focus()}else if(!e&&o){o.focus()}}};A.prototype._registerContentResizeHandler=function(t){if(!this._sResizeListenerId){this._sResizeListenerId=d.register(t||this.getDomRef("scroll"),this._fnOrientationChange)}};A.prototype._deregisterContentResizeHandler=function(){if(this._sResizeListenerId){d.deregister(this._sResizeListenerId);this._sResizeListenerId=null}};A.prototype._storeScrollPosition=function(){var t=this.$("cont");if(t.length>0){this._oScrollPosDesktop={x:t.scrollLeft(),y:t.scrollTop()}}};A.prototype._restoreScrollPosition=function(){if(!this._oScrollPosDesktop){return}var t=this.$("cont");if(t.length>0){t.scrollLeft(this._oScrollPosDesktop.x).scrollTop(this._oScrollPosDesktop.y);this._oScrollPosDesktop=null}};A.prototype._repositionOffset=function(){var t=this.oPopup.getOpenState(),e,o;if(!(t===O.OPEN)){return this}e=this.oPopup._oLastPosition;o=this._placements.indexOf(this.getPlacement());if(o===-1){return this}if(o<4){e.offset=this._calcOffset(this._offsets[o]);this.oPopup._applyPosition(e)}else{this._calcPlacement()}return this};A.prototype._getOpenByDomRef=function(){if(!this._oOpenBy){return null}if(this._oOpenBy instanceof u){return this._oOpenBy.getPopupAnchorDomRef&&this._oOpenBy.getPopupAnchorDomRef()||this._oOpenBy.getFocusDomRef()}else{return this._oOpenBy}};A.prototype._getAccessibilityOptions=function(){var t,e={},o=this._getAnyHeader(),i=this.getCustomHeader();e.role="dialog";e.modal=this.getProperty("ariaModal");if(!this.getShowHeader()||!o||!o.getVisible()){return e}var r=i?i.getId():this.getHeaderTitle().getId();t=Array.prototype.concat(r,this.getAssociation("ariaLabelledBy",[]));e.labelledby=t.join(" ");return e};A.prototype._setHeaderTitle=function(){if(!this._headerTitle){this._headerTitle=new r(this.getId()+"-title",{text:this.getTitle(),level:"H1"});this._createInternalHeader();this._internalHeader.addContentMiddle(this._headerTitle);return}if(this._headerTitle.getText()!==this.getTitle()){this._headerTitle.setText(this.getTitle())}};A.prototype.getHeaderTitle=function(){return this._headerTitle};A.prototype.setPlacement=function(t){this.setProperty("placement",t,true);this._bVerticalFlip=false;this._bHorizontalFlip=false;var e=this._placements.indexOf(t);if(e<=3){this._oCalcedPos=t}return this};A.prototype.setBeginButton=function(t){var e=this.getBeginButton();if(e===t){return this}this._createInternalHeader();this._beginButton=t;if(t){if(e){this._internalHeader.removeAggregation("contentLeft",e,true)}this._internalHeader.addAggregation("contentLeft",t)}else{this._internalHeader.removeContentLeft(e)}return this};A.prototype.setEndButton=function(t){var e=this.getEndButton();if(e===t){return this}this._createInternalHeader();this._endButton=t;this._internalHeader.removeContentRight(e);if(t){this._internalHeader.addContentRight(t)}return this};A.prototype.setLeftButton=function(t){if(!(t instanceof e)){t=u.getElementById(t)}this.setBeginButton(t);return this.setAssociation("leftButton",t)};A.prototype.setRightButton=function(t){if(!(t instanceof e)){t=u.getElementById(t)}this.setEndButton(t);return this.setAssociation("rightButton",t)};A.prototype.setModal=function(t,e){if(t===this.getModal()){return this}this.oPopup.setModal(t,("sapMPopoverBLayer "+(e||"")).trim());this.setProperty("modal",t,true);return this};A.prototype.setEnableScrolling=function(t){this.setHorizontalScrolling(t);this.setVerticalScrolling(t);this.setProperty("enableScrolling",t);return this};A.prototype._setAriaModal=function(t){return this.setProperty("ariaModal",t)};A.prototype.getScrollDelegate=function(){return this._oScroller};A.prototype._setAriaRoleApplication=function(t){return this.setProperty("ariaRoleApplication",t)};A.prototype.setAggregation=function(t,e,o){if(t==="beginButton"||t==="endButton"){var i="set"+t.charAt(0).toUpperCase()+t.slice(1);return this[i](e)}else{return a.prototype.setAggregation.apply(this,arguments)}};A.prototype.getAggregation=function(t,e){if(t==="beginButton"||t==="endButton"){var o=this["_"+t];return o||e||null}else{return a.prototype.getAggregation.apply(this,arguments)}};A.prototype.destroyAggregation=function(t,e){if(t==="beginButton"||t==="endButton"){var o=this["_"+t];if(o){o.destroy();this["_"+t]=null}}else{a.prototype.destroyAggregation.apply(this,arguments)}return this};A.prototype.invalidate=function(t){if(this.oPopup&&this.isOpen()&&this.oPopup.getOpenState()!==O.CLOSING){a.prototype.invalidate.apply(this,arguments)}return this};A.prototype.addAggregation=function(t,e,o){if(t==="content"){this._bContentChanged=true}a.prototype.addAggregation.apply(this,arguments)};A.prototype._getAllContent=function(){return this.getContent()};A.prototype._applyContextualSettings=function(){a.prototype._applyContextualSettings.call(this)};A.prototype._addDocumentEventListeners=function(){if(!this._bDocumentListenersAdded){this._bDocumentListenersAdded=true;this._fnHandleDocumentKeydown=t=>{if(this.oPopup.isTopmost()&&t.which===y.ESCAPE){this.close()}};document.addEventListener("keydown",this._fnHandleDocumentKeydown)}};A.prototype._removeDocumentEventListeners=function(){if(this._bDocumentListenersAdded){this._bDocumentListenersAdded=false;document.removeEventListener("keydown",this._fnHandleDocumentKeydown)}};return A});
//# sourceMappingURL=Popover.js.map