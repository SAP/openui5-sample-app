/*!
 * OpenUI5
 * (c) Copyright 2009-2023 SAP SE or an SAP affiliate company.
 * Licensed under the Apache License, Version 2.0 - see LICENSE.txt.
 */
sap.ui.define(["sap/ui/unified/calendar/CalendarDate","sap/ui/unified/calendar/CalendarUtils","sap/ui/core/date/UniversalDate","sap/ui/core/IconPool","sap/ui/core/InvisibleText","./PlanningCalendarLegend","sap/ui/unified/library","sap/ui/core/Configuration","sap/ui/core/date/UI5Date"],function(e,t,a,l,n,r,s,o,i){"use strict";var d=.125;var p=.125;var c=.0625;var g=s.CalendarDayType;var S={apiVersion:2};S.render=function(e,t){e.openStart("div",t);e.class("sapMSinglePCGrid");e.openEnd();e.renderControl(t.getAggregation("_columnHeaders"));this.renderBlockersContainer(e,t);e.openStart("div");e.attr("role","grid");e.class("sapMSinglePCGridContent");e.openEnd();this.renderRowHeaders(e,t);this.renderNowMarker(e,t);this.renderColumns(e,t);e.close("div");e.close("div")};S.renderBlockersContainer=function(a,l){var s=l._getColumns(),o=l._getBlockersToRender().iMaxlevel,i=l.getStartDate(),d=(o+1)*l._getBlockerRowHeight()+.1875,p=l._getDateFormatter(),c=l._getSpecialDates(),g=e.fromLocalJSDate(i),S=l._getColumnHeaders()._getDateTypes(g),u,f;a.openStart("div");a.attr("role","grid");a.class("sapMSinglePCBlockersRow");a.openEnd();a.openStart("div");a.attr("role","row");a.class("sapMSinglePCBlockersColumns");if(c&&l._getColumns()===1){if(S&&S[0]){u=S[0];a.class("sapUiCalItem"+u.type);f=r.findLegendItemForItem(sap.ui.getCore().byId(l._sLegendId),u)}a.class("sapMSpecialDaysInDayView")}a.style("height",d+"rem");a.openEnd();this.renderDndPlaceholders(a,l,l.getAggregation("_blockersPlaceholders"));for(var C=0;C<s;C++){var v=new e(i.getFullYear(),i.getMonth(),i.getDate()+C);a.openStart("div");a.attr("role","gridcell");a.attr("data-sap-start-date",p.format(v.toLocalJSDate()));a.attr("data-sap-end-date",p.format(v.toLocalJSDate()));a.attr("aria-labelledby",n.getStaticId("sap.m","SPC_BLOCKERS")+" "+"fullDay-"+p.format(v.toLocalJSDate())+"-Descr");a.class("sapMSinglePCBlockersColumn");a.attr("tabindex",-1);if(l._checkDateSelected(v)&&s>1){this.renderSelectedRowBorders(a,l,C,v,s,"Blocker")}if(v.isSame(new e)){a.class("sapMSinglePCBlockersColumnToday")}if(t._isWeekend(v,l._getCoreLocaleData())){a.class("sapMSinglePCBlockersColumnWeekend")}a.openEnd();a.openStart("span","fullDay-"+p.format(v.toLocalJSDate())+"-Descr");a.class("sapUiInvisibleText");a.openEnd();a.text(l._getCellStartEndInfo(v.toLocalJSDate()));if(l._sLegendId&&f){a.text(f)}a.close("span");a.close("div")}this.renderBlockers(a,l);a.close("div");a.close("div")};S.renderSelectedRowBorders=function(t,a,l,n,r,s){var o=new e(n.toLocalJSDate().getFullYear(),n.toLocalJSDate().getMonth(),n.toLocalJSDate().getDate()-1);var i=new e(n.toLocalJSDate().getFullYear(),n.toLocalJSDate().getMonth(),n.toLocalJSDate().getDate()+1);t.class("sapUiCalColumnSelected");if(l==0&&a._checkDateSelected(i)){t.class("sapUiCalColumnSelectedStart"+s)}else if(l==0&&!a._checkDateSelected(i)){t.class("sapUiCalColumnSingleSelect"+s)}else if(l===r-1&&a._checkDateSelected(o)){t.class("sapUiCalColumnSelectedEnd"+s)}else if(l===r-1&&!a._checkDateSelected(o)){t.class("sapUiCalColumnSingleSelect"+s)}else if(a._checkDateSelected(o)&&a._checkDateSelected(i)){t.class("sapUiCalColumnSelectedBetween"+s)}else if(a._checkDateSelected(o)){t.class("sapUiCalColumnSelectedEnd"+s)}else if(a._checkDateSelected(i)){t.class("sapUiCalColumnSelectedStart"+s)}else{t.class("sapUiCalColumnSingleSelect"+s)}};S.renderBlockers=function(e,t){var a=this,l=t._getBlockersToRender().oBlockersList;e.openStart("div");e.attr("role","list");e.attr("aria-labelledby",n.getStaticId("sap.m","SPC_BLOCKERS"));e.class("sapMSinglePCBlockers");e.class("sapUiCalendarRowVisFilled");e.openEnd();l.getIterator().forEach(function(l){a.renderBlockerAppointment(e,t,l)});e.close("div")};S.renderBlockerAppointment=function(a,l,r){var s=e.fromLocalJSDate(l.getStartDate()),i=r.getData(),d=e.fromLocalJSDate(i.getStartDate()),p=e.fromLocalJSDate(i.getEndDate()),c=t._daysBetween(d,s),S=t._daysBetween(p,s),u=l._getColumns(),f=l._getBlockerRowHeight(),C=r.level,v=r.width,m=i.getTooltip_AsString(),b=i.getType(),A=i.getColor(),D=i.getTitle(),_=i.getText(),T=i.getIcon(),M=i.getId(),h={role:"listitem",labelledby:{value:n.getStaticId("sap.ui.unified","APPOINTMENT"),append:true},selected:null},y=l.getAriaLabelledBy(),w=c*(100/u),E=(u-S-1)*(100/u),P=o.getRTL(),I;if(y.length>0){h["labelledby"].value=h["labelledby"].value+" "+y.join(" ")}if(D){h["labelledby"].value=h["labelledby"].value+" "+M+"-Title"}h["labelledby"].value=h["labelledby"].value+" "+M+"-Descr";if(_){h["labelledby"].value=h["labelledby"].value+" "+M+"-Text"}if(i.getTentative()){h["labelledby"].value=h["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE")}if(i.getSelected()){h["labelledby"].value=h["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED")}a.openStart("div",i);a.attr("data-sap-level",C);a.attr("data-sap-width",v);a.attr("tabindex",0);if(m){a.attr("title",m)}a.accessibilityState(i,h);a.class("sapMSinglePCAppointmentWrap");a.class("sapUiCalendarRowApps");if(!A&&b!==g.None){a.class("sapUiCalendarApp"+b)}if(A){if(o.getRTL()){a.style("border-right-color",A)}else{a.style("border-left-color",A)}}a.style("top",f*C+.0625+"rem");a.style(P?"right":"left",Math.max(w,0)+"%");a.style(P?"left":"right",Math.max(E,0)+"%");a.openEnd();a.openStart("div");a.class("sapUiCalendarApp");if(i.getSelected()){a.class("sapUiCalendarAppSel")}if(i.getTentative()){a.class("sapUiCalendarAppTent")}if(T){a.class("sapUiCalendarAppWithIcon")}a.openEnd();a.openStart("div");a.class("sapUiCalendarAppCont");if(A){a.style("background-color",i._getCSSColorForBackground(A))}a.openEnd();if(w<0){I=["sapUiCalendarAppArrowIconLeft","sapUiCalendarAppArrowIcon"];a.icon("sap-icon://arrow-left",I,{title:null,role:"img"})}if(T){I=["sapUiCalendarAppIcon"];var U={};U["id"]=M+"-Icon";U["title"]=null;U["role"]="img";a.icon(T,I,U)}if(D){a.openStart("span",M+"-Title");a.class("sapUiCalendarAppTitle");a.openEnd();a.text(D,true);a.close("span")}if(E<0){I=["sapUiCalendarAppArrowIconRight","sapUiCalendarAppArrowIcon"];a.icon("sap-icon://arrow-right",I,{title:null,role:"img"})}a.openStart("span",M+"-Descr");a.class("sapUiInvisibleText");a.openEnd();a.text(l._getAppointmentAnnouncementInfo(i));a.close("span");a.close("div");a.close("div");a.close("div")};S.renderRowHeaders=function(e,t){var a=t._getVisibleStartHour(),l=t._getVisibleEndHour(),n=i.getInstance(),r=t._getHoursFormat(),s=t._getAMPMFormat();e.openStart("div");e.class("sapMSinglePCRowHeaders");e.openEnd();for(var o=a;o<=l;o++){n.setHours(o);e.openStart("span");e.class("sapMSinglePCRowHeader");e.class("sapMSinglePCRowHeader"+o);if(t._shouldHideRowHeader(o)){e.class("sapMSinglePCRowHeaderHidden")}e.openEnd();e.text(r.format(n));if(t._hasAMPM()){e.openStart("span");e.class("sapMSinglePCRowHeaderAMPM");e.openEnd();e.text(" "+s.format(n));e.close("span")}e.close("span")}e.close("div")};S.renderColumns=function(a,l){var r=l._getColumns(),s=l.getStartDate(),o=l._getAppointmentsToRender();a.openStart("div");a.attr("role","grid");a.attr("aria-labelledby",n.getStaticId("sap.m","SPC_APPOINTMENTS"));a.class("sapMSinglePCColumns");a.openEnd();for(var i=0;i<r;i++){var d=new e(s.getFullYear(),s.getMonth(),s.getDate()+i),p=l._getDateFormatter(),c=p.format(d.toLocalJSDate());a.openStart("div");a.attr("role","row");a.attr("data-sap-day",c);a.class("sapMSinglePCColumn");if(l._checkDateSelected(d)&&r>1){this.renderSelectedRowBorders(a,l,i,d,r,"Column")}if(d.isSame(new e)){a.class("sapMSinglePCColumnToday")}if(t._isWeekend(d,l._getCoreLocaleData())){a.class("sapMSinglePCColumnWeekend")}a.openEnd();this.renderDndPlaceholders(a,l,l._dndPlaceholdersMap[d]);this.renderRows(a,l,c);this.renderAppointments(a,l,o[c],d,i);a.close("div")}a.close("div")};S.renderDndPlaceholders=function(e,t,a){e.openStart("div");e.class("sapMSinglePCOverlay");e.openEnd();a.forEach(e.renderControl,e);e.close("div")};S.renderRows=function(e,t,a){var l=t._getVisibleStartHour(),n=t._getVisibleEndHour(),r=t._getDateFormatter(),s,o;for(var d=l;d<=n;d++){s=t._parseDateStringAndHours(a,d);o=i.getInstance(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours()+1);e.openStart("div");e.attr("role","gridcell");e.class("sapMSinglePCRow");if(!t._isVisibleHour(d)){e.class("sapMSinglePCNonWorkingRow")}e.attr("data-sap-hour",d);e.attr("data-sap-start-date",r.format(s));e.attr("data-sap-end-date",r.format(o));e.attr("aria-labelledby",r.format(s)+"-Descr");e.attr("tabindex",-1);e.openEnd();e.openStart("span",r.format(s)+"-Descr");e.class("sapUiInvisibleText");e.openEnd();e.text(t._getCellStartEndInfo(s,o));e.close("span");e.close("div")}};S.renderAppointments=function(e,t,a,l,n){var r=this,s=0;if(a){e.openStart("div");e.attr("role","list");e.class("sapMSinglePCAppointments");e.class("sapUiCalendarRowVisFilled");e.openEnd();a.oAppointmentsList.getIterator().forEach(function(o){var i=a.iMaxLevel,d=o.level,p=o.width,c=o.getData();r.renderAppointment(e,t,i,d,p,c,l,n,s);s++});e.close("div")}};S.renderAppointment=function(l,r,s,i,S,u,f,C,v){var m=e.fromLocalJSDate(r.getStartDate()),b=new e(m),A=r._getRowHeight(),D=new a(f.getYear(),f.getMonth(),f.getDate(),r._getVisibleStartHour()),_=new a(f.getYear(),f.getMonth(),f.getDate(),r._getVisibleEndHour(),59,59),T=u.getStartDate(),M=u.getEndDate(),h=e.fromLocalJSDate(T),y=e.fromLocalJSDate(M),w=u.getTooltip_AsString(),E=u.getType(),P=u.getColor(),I=u.getTitle(),U=u.getText(),k=u.getIcon(),L=u.getId(),R=this._getLineClamp(T,M),B={role:"listitem",labelledby:{value:n.getStaticId("sap.ui.unified","APPOINTMENT"),append:true},selected:null},x=r.getAriaLabelledBy(),H=D.getTime()>T.getTime(),N=_.getTime()<M.getTime(),J=H?0:r._calculateTopPosition(T),F=N?0:r._calculateBottomPosition(M),V=100/(s+1),O=u.getParent().getEnableAppointmentsDragAndDrop(),W=r.getProperty("scaleFactor"),Y=2*W,z,j,G,K,q;b.setDate(b.getDate()+r._getColumns()-1);z=t._daysBetween(h,m);j=t._daysBetween(b,y);G=f.isSame(m);K=f.isSame(b);if(x.length>0){B["labelledby"].value=B["labelledby"].value+" "+x.join(" ")}if(I){B["labelledby"].value=B["labelledby"].value+" "+L+"-Title"}B["labelledby"].value=B["labelledby"].value+" "+L+"-Descr";if(U){B["labelledby"].value=B["labelledby"].value+" "+L+"-Text"}if(u.getTentative()){B["labelledby"].value=B["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_TENTATIVE")}if(u.getSelected()){B["labelledby"].value=B["labelledby"].value+" "+n.getStaticId("sap.ui.unified","APPOINTMENT_SELECTED")}l.openStart("div",u.getId()+"-"+C+"_"+v);l.attr("draggable",O);l.attr("data-sap-ui-draggable",O);l.attr("data-sap-ui-related",u.getId());l.attr("data-sap-level",i);l.attr("data-sap-width",S);l.attr("tabindex",0);if(w){l.attr("title",w)}l.accessibilityState(u,B);l.class("sapMSinglePCAppointmentWrap");l.class("sapUiCalendarRowApps");if(!P&&E!==g.None){l.class("sapUiCalendarApp"+E)}if(P){if(o.getRTL()){l.style("border-right-color",P)}else{l.style("border-left-color",P)}}l.style("top",J+"rem");l.style("bottom",F+"rem");l.style(o.getRTL()?"right":"left",V*i+"%");l.style("width",V*S+"%");l.openEnd();l.openStart("div");l.class("sapUiCalendarApp");l.style("min-height",(A-(d+p+c)*W)/Y+"rem");if(u.getSelected()){l.class("sapUiCalendarAppSel")}if(u.getTentative()){l.class("sapUiCalendarAppTent")}if(k){l.class("sapUiCalendarAppWithIcon")}l.openEnd();l.openStart("div");l.class("sapUiCalendarAppCont");if(P){l.style("background-color",u._getCSSColorForBackground(P))}l.openEnd();if(G&&z<0){q=["sapUiCalendarAppArrowIconLeft","sapUiCalendarAppArrowIcon"];l.icon("sap-icon://arrow-left",q,{title:null,role:"img"})}if(k){q=["sapUiCalendarAppIcon"];var Q={};Q["id"]=L+"-Icon";Q["title"]=null;Q["role"]="img";l.icon(k,q,Q)}l.openStart("div");l.class("sapUiCalendarAppTitleWrapper");l.class("sapUiSPCAppLineClamp"+R);l.openEnd();if(I){l.openStart("span",L+"-Title");l.class("sapUiCalendarAppTitle");l.openEnd();l.text(I,true);l.close("span")}if(U){l.openStart("span",L+"-Text");l.class("sapUiCalendarAppText");l.openEnd();l.text(U,true);l.close("span")}l.close("div");if(K&&j<0){q=["sapUiCalendarAppArrowIconRight","sapUiCalendarAppArrowIcon"];l.icon("sap-icon://arrow-right",q,{title:null,role:"img"})}l.openStart("span",L+"-Descr");l.class("sapUiInvisibleText");l.openEnd();l.text(r._getAppointmentAnnouncementInfo(u));l.close("span");l.close("div");if(r.getEnableAppointmentsResize()){this.renderResizeHandles(l,!H,!N)}l.close("div");l.close("div")};S.renderNowMarker=function(e,t){var a=i.getInstance();e.openStart("div",t.getId()+"-nowMarker");e.style("top",t._calculateTopPosition(a)+"rem");e.class("sapMSinglePCNowMarker");if(!t._isVisibleHour(a.getHours())){e.class("sapMSinglePCNowMarkerHidden")}e.openEnd();e.openStart("span",t.getId()+"-nowMarkerText");e.class("sapMSinglePCNowMarkerText");e.openEnd();e.text(t._formatTimeAsString(a));if(t._hasAMPM()){e.openStart("span",t.getId()+"-nowMarkerAMPM");e.class("sapMSinglePCNowMarkerAMPM");e.openEnd();e.text(t._addAMPM(a));e.close("span")}e.close("span");e.close("div")};S.renderResizeHandles=function(e,t,a){if(a){e.openStart("span");e.class("sapMSinglePCAppResizeHandleBottom");e.openEnd();e.close("span")}if(t){e.openStart("span");e.class("sapMSinglePCAppResizeHandleTop");e.openEnd();e.close("span")}};S._getLineClamp=function(e,a){var l=t._minutesBetween(e,a);if(l>=51&&l<69){return"2"}else if(l>=69&&l<90){return"3"}else if(l>=90&&l<110){return"4"}else if(l>=110&&l<130){return"5"}else if(l>=130&&l<150){return"6"}else if(l>=150&&l<170){return"7"}else if(l>=170&&l<190){return"8"}else if(l>=190){return"9"}else{return"1"}};return S},true);
//# sourceMappingURL=SinglePlanningCalendarGridRenderer.js.map